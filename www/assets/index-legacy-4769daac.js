System.register(["../vendors/element-plus-legacy-e48d1ae3.js","./failed-legacy-8aadbc20.js","./index-legacy.acc39ef9.js","./md5-legacy-47b02aeb.js"],(function(e){"use strict";var a,t,l,o,r,s,d,c,i,n,p,u,m,v,y,h,F,w,f,S,V,b,g,A,k,C;return{setters:[function(e){a=e.d,t=e.r,l=e.c,o=e.w,r=e.I,s=e.S,d=e.E,c=e.m,i=e.q,n=e.G,p=e.y,u=e.F,m=e.A,v=e.K,y=e.t,h=e.x,F=e.C},function(e){w=e.r,f=e.b,S=e.c,V=e.d,b=e._},function(e){g=e.r,A=e.U,k=e._},function(e){C=e._}],execute:function(){function I(e){return g.post(A.DANGER.beginReturnProcedure,e)}function _(e){return g.post(A.DANGER.beginCheckProcedure,e)}e({a:function(e){return g.post(A.DANGER.querySecondPerson,{DepartmentIds:e})},b:function(e){return g.post(A.INVENTORY.modifyInventoryCheckList,e)},c:function(e){return g.post(A.INVENTORY.endInventoryCheck,e)},d:function(e){return g.post(A.INVENTORY.abandonInventoryCheck,e)},e:function(e){return g.post(A.WAREHOUSE.queryWarehouse,e)},f:function(e){return g.post(A.INVENTORY.queryInventory,e)},g:function(e){return g.post(A.INWAREHOUSE.batchReturn,e)},h:function(e){return g.post(A.DANGER.querySecondPerson,{DepartmentIds:e})},r:function(e){return g.post(A.INVENTORY.beginInventoryCheck,e)}});const N=a({props:{purpose:{type:String,required:!0},param:{type:String,required:!0},dialogShow:{type:Boolean,required:!0},acceptors:{type:Array,required:!0},ids:{type:[Array,String],required:!0}},emits:["validate-success","update:dialogShow"],setup(e,{emit:a}){const d=t({dialogShow:!1,validateForm1:{way:"1",validateSuccess:!1,acceptor:"",password:"",captcha:""},validateForm2:{way:"1",validateSuccess:!1,acceptor:"",password:"",captcha:""},isSecondAdminFailed:!1}),c=l((()=>!d.validateForm1.acceptor||!d.validateForm2.acceptor)),i=l((()=>"DeliverOrder"===e.purpose?w:"Use"===e.purpose?f:"Return"===e.purpose?I:"FinishStockTaking"===e.purpose?_:void 0)),n={handleValidateFirstAcceptor(){const a=e.ids,t=d.validateForm1.acceptor,l=d.validateForm2.acceptor;return i.value({[e.param]:a,Admins:[t,l]}).then((()=>{const{acceptor:t,way:l,password:o,captcha:s}=r(d.validateForm1);if("1"===l){const l=C(`${o}-91360`),r=String(Math.floor(Date.now()/1e3)),s=C(`${l}-${r}`);return S({InspectionType:e.purpose,OrderIds:Array.isArray(a)?a:[a],IsFirstAdmin:!0,Username:t,Password:s,salt:r}).then((()=>{d.validateForm1.validateSuccess=!0}))}if("2"===l)return V({InspectionType:e.purpose,OrderIds:Array.isArray(a)?a:[a],IsFirstAdmin:!0,MobileCode:s}).then((()=>{d.validateForm1.validateSuccess=!0}))}))},async handleValidateSecondAcceptor(){d.isSecondAdminFailed&&(d.validateForm1.validateSuccess=!1,await n.handleValidateFirstAcceptor());const t=Array.isArray(e.ids)?e.ids:[e.ids],{acceptor:l,way:o,password:s,captcha:c}=r(d.validateForm2);if("1"===o){const o=C(`${s}-91360`),r=String(Math.floor(Date.now()/1e3)),c=C(`${o}-${r}`);S({InspectionType:e.purpose,OrderIds:t,IsFirstAdmin:!1,Username:l,Password:c,salt:r}).then((()=>{d.validateForm2.validateSuccess=!0,a("validate-success"),d.isSecondAdminFailed=!1})).catch((()=>{d.isSecondAdminFailed=!0}))}else"2"===o&&V({InspectionType:e.purpose,OrderIds:t,IsFirstAdmin:!1,MobileCode:c}).then((()=>{d.validateForm2.validateSuccess=!0,a("validate-success"),d.isSecondAdminFailed=!1})).catch((()=>{d.isSecondAdminFailed=!0}))},handleCloseValidateAcceptorDialog(){d.dialogShow=!1,a("update:dialogShow",!1)}};return o((()=>e.dialogShow),(e=>{e&&(d.dialogShow=!0)})),o((()=>e.dialogShow),(e=>{e||(d.validateForm1={way:"1",validateSuccess:!1,acceptor:"",password:"",captcha:""},d.validateForm2={way:"1",validateSuccess:!1,acceptor:"",password:"",captcha:""})})),o((()=>d.validateForm1.way),(e=>{"3"===e&&s.warning("生物识别的功能正在开发中，请耐心等待")})),o((()=>d.validateForm2.way),(e=>{"3"===e&&s.warning("生物识别的功能正在开发中，请耐心等待")})),{props:e,state:d,acceptorsNotChosen:c,reqBeginProcess:i,...n}}}),U=p("div",{class:"title"},"双人双锁验证",-1),E={class:"feedback-img",src:b,alt:"验证成功"},R=F("确认识别"),D=p("span",{class:"separator"},"|",-1),O=p("span",{class:"separator"},"|",-1),q={class:"feedback-img",src:b,alt:"验证成功"},P=F("确认识别 "),T=p("span",{class:"separator"},"|",-1),$=p("span",{class:"separator"},"|",-1),G={class:"center-footer"},Y=F("取消"),j=F("确认");e("V",k(N,[["render",function(e,a,t,l,o,r){const s=d("el-option"),F=d("el-select"),w=d("el-form-item"),f=d("el-input"),S=d("el-button"),V=d("el-form"),b=d("el-dialog");return c(),i(b,{"custom-class":"validate-acceptor",width:"940px",modelValue:e.state.dialogShow,"onUpdate:modelValue":a[15]||(a[15]=a=>e.state.dialogShow=a),onClose:e.handleCloseValidateAcceptorDialog},{title:n((()=>[U])),footer:n((()=>[p("div",G,[p(S,{class:"cancel",onClick:e.handleCloseValidateAcceptorDialog},{default:n((()=>[Y])),_:1},8,["onClick"]),p(S,{type:"primary",class:"confirm",onClick:e.handleCloseValidateAcceptorDialog},{default:n((()=>[j])),_:1},8,["onClick"])])])),default:n((()=>[p(V,{model:e.state.validateForm1,inline:""},{default:n((()=>[p(w,{label:"第一验收人"},{default:n((()=>[p(F,{modelValue:e.state.validateForm1.acceptor,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.validateForm1.acceptor=a),placeholder:"请选择第一验收人"},{default:n((()=>[(c(!0),i(u,null,m(e.acceptors,(e=>(c(),i(s,{label:e.label,value:e.value,key:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),"1"===e.state.validateForm1.way?(c(),i(w,{key:0,label:"身份验证"},{default:n((()=>[p(f,{modelValue:e.state.validateForm1.password,"onUpdate:modelValue":a[2]||(a[2]=a=>e.state.validateForm1.password=a),type:"password","show-password":"",clearable:"",placeholder:"请输入用户密码"},null,8,["modelValue"])])),_:1})):v("",!0),"2"===e.state.validateForm1.way?(c(),i(w,{key:1,label:"身份识别"},{default:n((()=>[p(f,{modelValue:e.state.validateForm1.captcha,"onUpdate:modelValue":a[3]||(a[3]=a=>e.state.validateForm1.captcha=a),clearable:"",placeholder:"请输入验证码"},null,8,["modelValue"])])),_:1})):v("",!0),"3"===e.state.validateForm1.way?(c(),i(w,{key:2,label:"身份验证"},{default:n((()=>[p(f,{disabled:"",modelValue:e.state.validateForm1.captcha,"onUpdate:modelValue":a[4]||(a[4]=a=>e.state.validateForm1.captcha=a),placeholder:"请登录APP待验证"},null,8,["modelValue"])])),_:1})):v("",!0),p(w,null,{default:n((()=>[y(p("img",E,null,512),[[h,e.state.validateForm1.validateSuccess]]),p(S,{type:"primary",disabled:e.acceptorsNotChosen,onClick:e.handleValidateFirstAcceptor},{default:n((()=>[R])),_:1},8,["disabled","onClick"])])),_:1}),p("span",{class:["accept-way-choice",{underline:"1"===e.state.validateForm1.way}],onClick:a[5]||(a[5]=a=>e.state.validateForm1.way="1")},"密码识别",2),D,p("span",{class:["accept-way-choice",{underline:"2"===e.state.validateForm1.way}],onClick:a[6]||(a[6]=a=>e.state.validateForm1.way="2")},"验证码识别",2),O,p("span",{class:["accept-way-choice",{underline:"3"===e.state.validateForm1.way}],onClick:a[7]||(a[7]=a=>e.state.validateForm1.way="3")},"生物识别",2)])),_:1},8,["model"]),p(V,{model:e.state.validateForm2,inline:""},{default:n((()=>[p(w,{label:"第二验收人"},{default:n((()=>[p(F,{modelValue:e.state.validateForm2.acceptor,"onUpdate:modelValue":a[8]||(a[8]=a=>e.state.validateForm2.acceptor=a),placeholder:"请选择第二验收人"},{default:n((()=>[(c(!0),i(u,null,m(e.acceptors,(e=>(c(),i(s,{label:e.label,value:e.value,key:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),"1"===e.state.validateForm2.way?(c(),i(w,{key:0,label:"身份验证"},{default:n((()=>[p(f,{modelValue:e.state.validateForm2.password,"onUpdate:modelValue":a[9]||(a[9]=a=>e.state.validateForm2.password=a),type:"password","show-password":"",clearable:"",placeholder:"请输入用户密码"},null,8,["modelValue"])])),_:1})):v("",!0),"2"===e.state.validateForm2.way?(c(),i(w,{key:1,label:"身份识别"},{default:n((()=>[p(f,{modelValue:e.state.validateForm2.captcha,"onUpdate:modelValue":a[10]||(a[10]=a=>e.state.validateForm2.captcha=a),clearable:"",placeholder:"请输入验证码"},null,8,["modelValue"])])),_:1})):v("",!0),"3"===e.state.validateForm2.way?(c(),i(w,{key:2,label:"身份验证"},{default:n((()=>[p(f,{disabled:"",modelValue:e.state.validateForm2.captcha,"onUpdate:modelValue":a[11]||(a[11]=a=>e.state.validateForm2.captcha=a),placeholder:"请登录APP待验证"},null,8,["modelValue"])])),_:1})):v("",!0),p(w,null,{default:n((()=>[y(p("img",q,null,512),[[h,e.state.validateForm2.validateSuccess]]),p(S,{type:"primary",disabled:e.acceptorsNotChosen||!e.state.validateForm1.validateSuccess,onClick:e.handleValidateSecondAcceptor},{default:n((()=>[P])),_:1},8,["disabled","onClick"])])),_:1}),p("span",{class:["accept-way-choice",{underline:"1"===e.state.validateForm2.way}],onClick:a[12]||(a[12]=a=>e.state.validateForm2.way="1")},"密码识别",2),T,p("span",{class:["accept-way-choice",{underline:"2"===e.state.validateForm2.way}],onClick:a[13]||(a[13]=a=>e.state.validateForm2.way="2")},"验证码识别",2),$,p("span",{class:["accept-way-choice",{underline:"3"===e.state.validateForm2.way}],onClick:a[14]||(a[14]=a=>e.state.validateForm2.way="3")},"生物识别",2)])),_:1},8,["model"])])),_:1},8,["modelValue","onClose"])}]]))}}}));
