var _=Object.defineProperty,z=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var N=(e,a,u)=>a in e?_(e,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[a]=u,E=(e,a)=>{for(var u in a||(a={}))U.call(a,u)&&N(e,u,a[u]);if(B)for(var u of B(a))X.call(a,u)&&N(e,u,a[u]);return e},P=(e,a)=>z(e,M(a));import{d as K,i as g,r as L,c as T,w as q,o as Y,E as i,m as f,q as S,y as o,G as s,N as m,F as O,A as W,z as V,I as w,C as c}from"../vendors/element-plus-6f9977bb.js";import{r as $,U as j,_ as G,d as Q,b as J}from"./index.1a2bb961.js";function Z(e){return $.post(j.DELIVERY.queryMiddleTableDelivery,e)}const x=K({setup(){const e=Q(),a=J(),u=g("exportXLSX"),y=g("exportPDF"),A=g("setTableHeaders"),D=()=>{l.loading=!0;const{pageSize:r,currentPage:h}=w(l.pagination),{dateRange:n,SOID:t,invoiceNumber:d,shortname:v,supplier:k}=w(l.searchParam),[R,H]=n||["",""];Z({DeliverOrderId:t,SearchWord:v,RequestPurchaseBeginDate:R,RequestPurchaseEndDate:H,InvoiceNo:d,ProviderName:k,NeedCheckIsAccept:!0,IsAccept:!0,NeedCheckHChemical:!1,IsHChemical:!1,NeedPaging:!0,PageNumber:h,RecordPerPage:r}).then(I=>{l.pagination.total=I.TotalRecordCount,b(I.DeliverOrders)}).finally(()=>{l.loading=!1})},b=r=>{l.tableData=r.map(h=>{const{InvoiceNo:n,material:t,deliverOrder:d}=h;return P(E({},d),{short_name:t==null?void 0:t.short_name,spec:t==null?void 0:t.spec,brandName:l.brandIdMap[t==null?void 0:t.brand_id],INVDETID:n,SODATE:d.SODATE.replace("T"," "),ENDDATE:d.ENDDATE.replace("T"," "),material_name:t==null?void 0:t.name,IsHazardousChemical:d.IsHazardousChemical?"\u662F":"\u5426"})})},l=L({loading:!1,searchParam:{dateRange:"",SOID:"",invoiceNumber:"",shortname:"",supplier:""},pagination:{currentPage:1,total:0,pageSize:30},headersConfig:[{label:"\u5E8F\u53F7",prop:"id"},{label:"\u4EA4\u8D27\u5355ID",prop:"SOID"},{label:"\u4EA4\u8D27\u5355\u53F7",prop:"SONO"},{label:"\u53D1\u7968ID",prop:"INVDETID"},{label:"\u4EA4\u8D27\u65E5\u671F",prop:"SODATE"},{label:"\u91C7\u8D2D\u5355\u53F7",prop:"PONO"},{label:"\u7269\u6599\u540D\u79F0",prop:"material_name"},{label:"\u7269\u6599\u7B80\u79F0",prop:"short_name"},{label:"\u7269\u6599\u89C4\u683C",prop:"spec",width:90},{label:"\u54C1\u724C",prop:"brandName"},{label:"\u662F\u5426\u5371\u9669\u54C1",prop:"IsHazardousChemical"},{label:"\u91C7\u8D2D\u5355\u660E\u7EC6\u53F7",prop:"PODETNO"},{label:"\u9662\u5185\u7801",prop:"DITEMCODE"},{label:"\u9A8C\u6536\u4EBA",prop:"Accepter1UserName"},{label:"\u9001\u8D27\u6570\u91CF",prop:"DQTY"},{label:"\u5355\u4F4D",prop:"DPACKUNIT"},{label:"\u6E29\u5EA6",prop:"ActualTemperature"},{label:"\u542B\u7A0E\u5355\u4EF7",prop:"DTAXPRC"},{label:"\u542B\u7A0E\u91D1\u989D",prop:"TAXAMT"},{label:"\u6279\u53F7",prop:"LOTNO"},{label:"\u6548\u671F",prop:"ENDDATE",width:160},{label:"\u53D1\u7968\u7A0E\u7387",prop:"TAXRATE"},{label:"\u53D1\u7968\u62AC\u5934",prop:"INVOICETITLE"},{label:"\u53D1\u7968\u4EE3\u7801",prop:"INVOICECODE"},{label:"\u53D1\u7968\u53F7\u7801",prop:"INVOICENO"}],tableData:[],PDFHandling:!1,brandIdMap:T(()=>e.getters.brandIdMap)}),p=r=>{r&&(l.pagination.currentPage=1),D()},C=T(()=>l.headersConfig.filter(r=>!r.hidden)),F={calcHeaderWidth:g("calcHeaderMinWidth"),handleClickSetting(){A(l.headersConfig,r=>{l.headersConfig=r})},handlePaginationChange(){p(!1)},handleSearch(){p(!0)},handleExportXLSX(){u(l.headersConfig,l.tableData,"\u9A8C\u6536\u8BB0\u5F55","\u9A8C\u6536\u8BB0\u5F55\u8BE6\u60C5")},handleExportPDF(){l.PDFHandling=!0,y(l.headersConfig,l.tableData,"\u9A8C\u6536\u8BB0\u5F55").finally(()=>{l.PDFHandling=!1})}};return q(()=>e.getters.settings,()=>{l.headersConfig=e.getters.settings[a.name]||l.headersConfig}),Y(()=>{D()}),P(E({state:l},F),{headersShown:C})}}),ee={class:"date-box"},ae=c("\u67E5\u8BE2"),le=c("\u5BFC\u51FAxlsx"),ne=c("\u5BFC\u51FApdf"),te=c("\u4E0A\u4F20\u8BC1\u4E66"),oe=c("\u6253\u5370\u6807\u8BB0"),ue=c("\u67E5\u770B\u5BFC\u51FA\u8BB0\u5F55");function re(e,a,u,y,A,D){const b=i("el-date-picker"),l=i("el-input"),p=i("el-button"),C=i("styled-search"),F=i("el-table-column"),r=i("styled-table"),h=i("styled-pagination");return f(),S(O,null,[o(C,{"hide-search-more":""},{"styled-search-left":s(()=>[o("div",ee,[o(b,{modelValue:e.state.searchParam.dateRange,"onUpdate:modelValue":a[1]||(a[1]=n=>e.state.searchParam.dateRange=n),type:"daterange","value-format":"YYYY-MM-DD","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue"])]),o(l,{modelValue:e.state.searchParam.SOID,"onUpdate:modelValue":a[2]||(a[2]=n=>e.state.searchParam.SOID=n),placeholder:"\u8BF7\u8F93\u5165\u4EA4\u8D27\u5355\u53F7",clearable:"",onKeydown:m(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),o(l,{modelValue:e.state.searchParam.invoiceNumber,"onUpdate:modelValue":a[3]||(a[3]=n=>e.state.searchParam.invoiceNumber=n),placeholder:"\u8BF7\u8F93\u5165\u53D1\u7968\u53F7",clearable:"",onKeydown:m(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),o(l,{modelValue:e.state.searchParam.shortname,"onUpdate:modelValue":a[4]||(a[4]=n=>e.state.searchParam.shortname=n),placeholder:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0\u3001\u7B80\u79F0",clearable:"",onKeydown:m(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),o(l,{modelValue:e.state.searchParam.supplier,"onUpdate:modelValue":a[5]||(a[5]=n=>e.state.searchParam.supplier=n),placeholder:"\u8BF7\u8F93\u5165\u4F9B\u5E94\u5546\u540D\u79F0",clearable:"",onKeydown:m(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),o(p,{type:"primary",class:"search",onClick:e.handleSearch},{default:s(()=>[ae]),_:1},8,["onClick"])]),"styled-search-right":s(()=>[o(p,{type:"success",class:"export",disabled:e.state.tableData.length===0,onClick:e.handleExportXLSX},{default:s(()=>[le]),_:1},8,["disabled","onClick"]),o(p,{type:"success",class:"export",loading:e.state.PDFHandling,disabled:e.state.tableData.length===0,onClick:e.handleExportPDF},{default:s(()=>[ne]),_:1},8,["loading","disabled","onClick"]),o(p,{type:"primary",class:"search"},{default:s(()=>[te]),_:1}),o(p,{type:"primary",class:"search"},{default:s(()=>[oe]),_:1}),o(p,{type:"primary",class:"search"},{default:s(()=>[ue]),_:1})]),_:1}),o(r,{loading:e.state.loading,setting:"",data:e.state.tableData,onClickSetting:e.handleClickSetting},{"table-columns":s(()=>[(f(!0),S(O,null,W(e.headersShown,(n,t)=>(f(),S(F,{"show-overflow-tooltip":"",key:t,prop:n.prop,label:n.label,"min-width":e.calcHeaderWidth(n,t)},{header:s(d=>[o("span",null,V(d.column.label),1)]),default:s(d=>[o("span",null,V(d.row[n.prop]),1)]),_:2},1032,["prop","label","min-width"]))),128))]),_:1},8,["loading","data","onClickSetting"]),o(h,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":a[6]||(a[6]=n=>e.state.pagination.currentPage=n),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":a[7]||(a[7]=n=>e.state.pagination.pageSize=n),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"])],64)}var ce=G(x,[["render",re]]);export{ce as default};
