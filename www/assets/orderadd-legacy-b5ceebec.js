System.register(["../vendors/element-plus-legacy-e48d1ae3.js","./index-legacy.acc39ef9.js","./department-legacy-7e39a566.js","./instrument-legacy-58deeedd.js"],(function(e){"use strict";var a,t,n,r,i,l,p,o,s,d,c,u,g,h,m,b,_,y,M,C,f,P,S,T,w;return{setters:[function(e){a=e.d,t=e.i,n=e.r,r=e.c,i=e.I,l=e.w,p=e.o,o=e.E,s=e.m,d=e.q,c=e.y,u=e.G,g=e.N,h=e.C,m=e.z,b=e.F,_=e.A},function(e){y=e.r,M=e.U,C=e._,f=e.u,P=e.b,S=e.d},function(e){T=e.d},function(e){w=e.i}],execute:function(){function v(e=""){return y.post(M.VENDOR.queryVendor,{search_word:e})}const D=a({setup(){const e=f(),a=P(),o=S(),s=t("setTableHeaders"),d=()=>{u.loading=!0;const{pageSize:e,currentPage:a}=i(u.pagination),{shortname:t,isDanger:n}=i(u.searchParam);(function(e){return y.post(M.MATERIAL.queryMaterial,e)})({searchWord:t,DepartmentId:"",MaterialType:"",BrandId:"",InstrumentId:"",NeedPaging:!0,PageNo:a,RecordPerPage:e,CheckHChemical:!0,IsHChemical:n}).then((e=>{u.pagination.total=e.TotalRecordCount,c(e.materials)})).finally((()=>{u.loading=!1}))},c=e=>{u.tableData=e.map((e=>{const{brand_id:a,departmentOwners:t,hospital_code:n,id:r,instrumentOwners:i,invoiceCorp:l,isGift:p,IsHazardousChemical:o,isMinUnitPurchase:s,isPublicReagent:d,material_type:c,minimumUnit:g,name:h,needPurchase:m,onBoardInfo:b,onBoardType:_,openValidDays:y,printOpenLabel:M,purchasePrice:C,purchaseUnit:f,shippingCorp:P,short_name:S,spec:v,stopUseReason:D,storeCondition:U,storePos:k,supplier:z,system_code:I,tempratureScope:O,uniqueCodeManage:V}=e,j=T(t).map((e=>u.departmentMaps[e])).join(","),q=w(i).map((e=>u.instrumentMaps[e])).join(",");return{serverObj:e,short_name:S,id:r,hospital_code:n,material_name:h,brand:u.brandMaps[a]||"未知品牌",system_code:I,is_danger:o?"是":"否",type:u.MaterialTypeMap.get(c),size:v,restore_condition:u.StoreTypeMap.get(U),temperature:O,arrived_scope:u.OnboardTypeMap.get(_),arrived_date:b,purchase_price:C,print_label:M?"是":"否",department:j,instrument:q,open_expire:`${y} 天`,purchase_unit:u.MinUnitTypeMap.get(f),min_unit:u.MinUnitTypeMap.get(g),unique_code:V?"是":"否",is_gift:p?"是":"否",store_position:k,purchase_status:m?"采购":"停购",stop_reason:D,public:d?"是":"否",min_unit_purchase:s?"是":"否",supplier:u.companyMaps[z],invoice_company:u.companyMaps[l],ship_company:u.companyMaps[P]}}))},u=n({loading:!1,MaterialTypeMap:r((()=>o.getters.MaterialTypeMap)),StoreTypeMap:r((()=>o.getters.StoreTypeMap)),MinUnitTypeMap:r((()=>o.getters.MinUnitTypeMap)),OnboardTypeMap:r((()=>o.getters.OnboardTypeMap)),searchParam:{shortname:"",isDanger:!1},pagination:{currentPage:1,total:0,pageSize:30},tableData:[],brandMaps:r((()=>o.getters.brandIdMap)),instrumentMaps:r((()=>o.getters.instrumentIdMap)),companyMaps:{},departmentMaps:{},headersConfig:[{label:"系统码",prop:"system_code"},{label:"院内码",prop:"hospital_code"},{label:"物料名称",prop:"material_name"},{label:"物料简称",prop:"short_name"},{label:"是否危险品",prop:"is_danger"},{label:"品牌",prop:"brand"},{label:"类型",prop:"type"},{label:"规格",prop:"size"},{label:"储存条件",prop:"restore_condition"},{label:"温度范围",prop:"temperature"},{label:"到货范围",prop:"arrived_scope"},{label:"到货日期",prop:"arrived_date"},{label:"采购单价",prop:"purchase_price"},{label:"打印开瓶标贴",prop:"print_label"},{label:"所属部门",prop:"department"},{label:"所属仪器",prop:"instrument"},{label:"开封效期",prop:"open_expire"},{label:"库存位置",prop:"store_position"},{label:"采购单位",prop:"purchase_unit"},{label:"最小单位",prop:"min_unit"},{label:"唯一管理码",prop:"unique_code"},{label:"是否赠品",prop:"is_gift"},{label:"采购状态",prop:"purchase_status"},{label:"公共试剂",prop:"public"},{label:"最小单位采购",prop:"min_unit_purchase"},{label:"供应商",prop:"supplier"},{label:"开票公司",prop:"invoice_company"},{label:"发货公司",prop:"ship_company"}],multipleSelection:[]}),g=e=>{e&&(u.pagination.currentPage=1),d()},h=r((()=>u.headersConfig.filter((e=>!e.hidden)))),m={calcHeaderWidth:t("calcHeaderMinWidth"),handleClickSetting(){s(u.headersConfig,(e=>{u.headersConfig=e}))},handlePaginationChange(){g(!1)},handleSearch(){g(!0)},handleAddOrder(){const a=i(u.multipleSelection);a.length&&e.push({name:"orderadding",params:{tableData:JSON.stringify(a)}})},handleChangeMultiple(e){u.multipleSelection=e}};return l((()=>o.getters.settings),(()=>{u.headersConfig=o.getters.settings[a.name]||u.headersConfig})),p((()=>{Promise.all([v().then((e=>{e.companies.forEach((e=>{u.companyMaps[e.id]=e.name}))})),y.get(M.DEPARTMENT.queryDepartment).then((e=>{e.departments.forEach((e=>{u.departmentMaps[e.id]=e.name}))}))]).then((()=>{d()}))})),{state:u,headersShown:h,...m}}}),U=h("查询"),k={key:1};e("default",C(D,[["render",function(e,a,t,n,r,i){const l=o("el-input"),p=o("el-button"),y=o("el-switch"),M=o("styled-search"),C=o("el-tag"),f=o("el-table-column"),P=o("styled-table"),S=o("styled-pagination");return s(),d(b,null,[c(M,{"hide-search-more":""},{"styled-search-left":u((()=>[c(l,{modelValue:e.state.searchParam.shortname,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.searchParam.shortname=a),placeholder:"请输入物料名称、简称、或院内码",clearable:"",onKeydown:g(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),c(p,{type:"primary",class:"search",onClick:e.handleSearch},{default:u((()=>[U])),_:1},8,["onClick"]),c(y,{modelValue:e.state.searchParam.isDanger,"onUpdate:modelValue":a[2]||(a[2]=a=>e.state.searchParam.isDanger=a),"active-text":"危险品","inactive-text":"非危险品",onChange:e.handleSearch},null,8,["modelValue","onChange"])])),"styled-search-right":u((()=>[c(p,{type:"primary",disabled:0===e.state.multipleSelection.length,class:"search",onClick:e.handleAddOrder},{default:u((()=>[h("去请购("+m(e.state.multipleSelection.length)+")",1)])),_:1},8,["disabled","onClick"])])),_:1}),c(P,{setting:"",loading:e.state.loading,multiple:"",data:e.state.tableData,onChangeMultiple:e.handleChangeMultiple,onClickSetting:e.handleClickSetting},{"table-columns":u((()=>[(s(!0),d(b,null,_(e.headersShown,((a,t)=>(s(),d(f,{"show-overflow-tooltip":"",key:t,prop:a.prop,label:a.label,"min-width":e.calcHeaderWidth(a,t)},{header:u((e=>[c("span",null,m(e.column.label),1)])),default:u((e=>["is_danger"===a.prop?(s(),d(C,{key:0,class:"是"===e.row.is_danger?"danger-material":"normal-material"},{default:u((()=>[h(m(e.row.is_danger),1)])),_:2},1032,["class"])):(s(),d("span",k,m(e.row[a.prop]),1))])),_:2},1032,["prop","label","min-width"])))),128))])),_:1},8,["loading","data","onChangeMultiple","onClickSetting"]),c(S,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":a[3]||(a[3]=a=>e.state.pagination.currentPage=a),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":a[4]||(a[4]=a=>e.state.pagination.pageSize=a),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"])],64)}]]))}}}));
