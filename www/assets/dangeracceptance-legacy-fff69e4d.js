System.register(["../vendors/element-plus-legacy-e48d1ae3.js","./index-legacy.acc39ef9.js","./department-legacy-7e39a566.js","./instrument-legacy-58deeedd.js"],(function(e){"use strict";var a,t,n,r,i,p,o,l,s,c,d,u,h,g,m,y,b,_,M,C,f,P,S,T,w,U;return{setters:[function(e){a=e.d,t=e.a,n=e.i,r=e.r,i=e.c,p=e.I,o=e.w,l=e.o,s=e.E,c=e.m,d=e.q,u=e.y,h=e.G,g=e.N,m=e.C,y=e.z,b=e.F,_=e.A},function(e){M=e.r,C=e.U,f=e._,P=e.u,S=e.d,T=e.b},function(e){w=e.d},function(e){U=e.i}],execute:function(){function k(e=""){return M.post(C.VENDOR.queryVendor,{search_word:e})}const v=a({name:"dangeracceptance",setup(){const e=P(),a=S(),s=T(),c={scanCodeRef:t(null)},d=n("setTableHeaders"),u=()=>{g.loading=!0;const{pageSize:e,currentPage:a}=p(g.pagination),{searchWord:t}=p(g.searchParam);(function(e){return M.post(C.MATERIAL.queryMaterial,e)})({searchWord:t,DepartmentId:"",MaterialType:"",BrandId:"",InstrumentId:"",NeedPaging:!0,PageNo:a,RecordPerPage:e,CheckHChemical:!0,IsHChemical:!0}).then((e=>{g.pagination.total=e.TotalRecordCount,h(e.materials)})).finally((()=>{g.loading=!1}))},h=e=>{g.tableData=e.map((e=>{const{brand_id:a,departmentOwners:t,hospital_code:n,id:r,instrumentOwners:i,invoiceCorp:p,isGift:o,isMinUnitPurchase:l,isPublicReagent:s,material_type:c,minimumUnit:d,name:u,needPurchase:h,onBoardInfo:m,onBoardType:y,openValidDays:b,printOpenLabel:_,purchasePrice:M,purchaseUnit:C,shippingCorp:f,short_name:P,spec:S,stopUseReason:T,storeCondition:k,storePos:v,supplier:z,system_code:I,tempratureScope:D,uniqueCodeManage:O}=e,R=w(t).map((e=>g.departmentMaps[e])).join(","),W=U(i).map((e=>g.instrumentMaps[e])).join(",");return{serverObj:e,short_name:P,storePos:v,id:r,hospital_code:n,material_name:u,brand:g.brandMaps[a]||"未知品牌",system_code:I,type:g.MaterialTypeMap.get(c),size:S,restore_condition:g.StoreTypeMap.get(k),temperature:D,arrived_scope:g.OnboardTypeMap.get(y),arrived_date:m,purchase_price:M,print_label:_?"是":"否",department:R,instrument:W,open_expire:`${b} 天`,purchase_unit:g.MinUnitTypeMap.get(C),min_unit:g.MinUnitTypeMap.get(d),unique_code:O?"是":"否",is_gift:o?"是":"否",store_position:v,purchase_status:h?"采购":"停购",stop_reason:T,public:s?"是":"否",min_unit_purchase:l?"是":"否",supplier:g.companyMaps[z],invoice_company:g.companyMaps[p],ship_company:g.companyMaps[f]}}))},g=r({loading:!1,searchParam:{searchWord:""},pagination:{currentPage:1,total:0,pageSize:30},headersConfig:[{label:"系统码",prop:"system_code"},{label:"院内码",prop:"hospital_code"},{label:"物料名称",prop:"material_name"},{label:"物料简称",prop:"short_name"},{label:"品牌",prop:"brand"},{label:"规格",prop:"size"},{label:"储存条件",prop:"restore_condition"},{label:"温度范围",prop:"temperature"},{label:"到货日期",prop:"arrived_date"},{label:"采购单价",prop:"purchase_price"},{label:"所属部门",prop:"department"},{label:"所属仪器",prop:"instrument"},{label:"开封效期",prop:"open_expire"},{label:"库位",prop:"store_position"},{label:"采购单位",prop:"purchase_unit"},{label:"最小单位",prop:"min_unit"},{label:"最小单位采购",prop:"min_unit_purchase"},{label:"供应商",prop:"supplier"},{label:"开票公司",prop:"invoice_company"},{label:"发货公司",prop:"ship_company"}],tableData:[],multipleSelection:[],brandMaps:i((()=>a.getters.brandIdMap)),instrumentMaps:i((()=>a.getters.instrumentIdMap)),companyMaps:{},departmentMaps:{},MaterialTypeMap:i((()=>a.getters.MaterialTypeMap)),StoreTypeMap:i((()=>a.getters.StoreTypeMap)),MinUnitTypeMap:i((()=>a.getters.MinUnitTypeMap)),OnboardTypeMap:i((()=>a.getters.OnboardTypeMap))}),m=e=>{e&&(g.pagination.currentPage=1),u()},y=i((()=>g.headersConfig.filter((e=>!e.hidden)))),b={calcHeaderWidth:n("calcHeaderMinWidth"),handleClickSetting(){d(g.headersConfig,(e=>{g.headersConfig=e}))},handlePaginationChange(){m(!1)},handleSearch(){m(!0)},handleChangeMultiple(e){g.multipleSelection=e},handleGoToAccept(){const a=p(g.multipleSelection);a.length&&e.push({name:"dangeraccepting",params:{chosenTableData:JSON.stringify(a)}})}};return o((()=>a.getters.settings),(()=>{g.headersConfig=a.getters.settings[s.name]||g.headersConfig})),l((()=>{Promise.all([k().then((e=>{e.companies.forEach((e=>{g.companyMaps[e.id]=e.name}))})),M.get(C.DEPARTMENT.queryDepartment).then((e=>{e.departments.forEach((e=>{g.departmentMaps[e.id]=e.name}))}))]).then(u)})),{state:g,...c,...b,headersShown:y}}}),z=m("查询");e("default",f(v,[["render",function(e,a,t,n,r,i){const p=s("el-input"),o=s("el-button"),l=s("styled-search"),M=s("el-table-column"),C=s("styled-table"),f=s("styled-pagination");return c(),d(b,null,[u(l,{"hide-search-more":""},{"styled-search-left":h((()=>[u(p,{modelValue:e.state.searchParam.searchWord,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.searchParam.searchWord=a),placeholder:"请输入物料名称、简称、或院内码",clearable:"",onKeydown:g(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),u(o,{type:"primary",class:"search",onClick:e.handleSearch},{default:h((()=>[z])),_:1},8,["onClick"])])),"styled-search-right":h((()=>[u(o,{type:"primary",disabled:0===e.state.multipleSelection.length,class:"search",onClick:e.handleGoToAccept},{default:h((()=>[m("去验收("+y(e.state.multipleSelection.length)+")",1)])),_:1},8,["disabled","onClick"])])),_:1}),u(C,{loading:e.state.loading,multiple:"",setting:"",data:e.state.tableData,onChangeMultiple:e.handleChangeMultiple,onClickSetting:e.handleClickSetting},{"table-columns":h((()=>[(c(!0),d(b,null,_(e.headersShown,((a,t)=>(c(),d(M,{"show-overflow-tooltip":"",key:t,prop:a.prop,label:a.label,"min-width":e.calcHeaderWidth(a,t)},{header:h((e=>[u("span",null,y(e.column.label),1)])),default:h((e=>[u("span",null,y(e.row[a.prop]),1)])),_:2},1032,["prop","label","min-width"])))),128))])),_:1},8,["loading","data","onChangeMultiple","onClickSetting"]),u(f,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":a[2]||(a[2]=a=>e.state.pagination.currentPage=a),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":a[3]||(a[3]=a=>e.state.pagination.pageSize=a),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"])],64)}]]))}}}));
