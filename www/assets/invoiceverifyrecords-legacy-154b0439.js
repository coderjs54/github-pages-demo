System.register(["../vendors/element-plus-legacy-e48d1ae3.js","./index-legacy.acc39ef9.js"],(function(e){"use strict";var a,o,t,i,l,n,r,d,c,s,u,p,m,g,v,h,f,y,b,C,I,P,S,V;return{setters:[function(e){a=e.d,o=e.i,t=e.c,i=e.a,l=e.r,n=e.I,r=e.S,d=e.w,c=e.o,s=e.E,u=e.m,p=e.q,m=e.y,g=e.G,v=e.N,h=e.F,f=e.A,y=e.z,b=e.C},function(e){C=e.r,I=e.U,P=e._,S=e.d,V=e.b}],execute:function(){const M=a({setup(){const e=S(),a=V(),s=o("setTableHeaders"),u=()=>{h.loading=!0;const{pageSize:e,currentPage:a}=n(h.pagination),{dateRange:o,invoiceNumber:t,invoiceProvider:i}=n(h.searchParam),[l,r]=o||["",""];(function(e){return C.post(I.INVOICE.queryInvoice,e)})({BeginPostingDate:l,EndPostingDate:r,InvoiceNo:t,DeliverOrderId:"",HospitalCode:"",ProviderName:i,VerifyStatus:"1",ApproveStatus:"2",PageNo:a,RecordPerPage:e}).then((e=>{h.pagination.total=e.TotalRecordCount,p(e.invoices)})).finally((()=>{h.loading=!1}))},p=e=>{h.tableData=e.map((e=>{const{INVOICEDATE:a,INVOICECODE:o,INVOICEAMT:t,INVOICENO:i,VerifyStatus:l,ApproveStatus:n,VerifyDate:r,SODATE:d,ProviderName:c}=e;return{invoiceNumber:i,invoiceSerialNumber:o,invoiceMoney:t,verifyStatus:l?"已核销":"待核销",checkStatus:n?"已审批":"待审批",receiveTime:a.substr(0,10),accountTime:r.substr(0,10),invoiceCreateTime:d.substr(0,10),provider:c}}))},m=e=>{e&&(h.pagination.currentPage=1),u()},g=t((()=>h.headersConfig.filter((e=>!e.hidden)))),v={modifyInvoiceFormRef:i(null)},h=l({loading:!1,searchParam:{dateRange:"",invoiceNumber:"",invoiceProvider:""},pagination:{currentPage:1,total:0,pageSize:30},invoiceProviderOptions:[],multipleSelection:[],headersConfig:[{label:"发票号",prop:"invoiceNumber"},{label:"发票编号",prop:"invoiceSerialNumber"},{label:"发票金额",prop:"invoiceMoney"},{label:"供应商",prop:"provider"},{label:"开票时间",prop:"invoiceCreateTime"},{label:"核销状态",prop:"verifyStatus"},{label:"审批状态",prop:"checkStatus"},{label:"数据接收时间",prop:"receiveTime"},{label:"账务日期",prop:"accountTime"}],tableData:[],dialogModifyInvoice:!1,modifyInvoiceForm:{invoiceId:"",date:""}}),f={calcHeaderMinWidth:o("calcHeaderMinWidth"),handleClickSetting(){s(h.headersConfig,(e=>{h.headersConfig=e}))},handleChangeMultiple(e){h.multipleSelection=e},handlePaginationChange(){m(!1)},handleSearch(){m(!0)},handleModify(e){const{accountTime:a,invoiceNumber:o}=n(e);h.modifyInvoiceForm={invoiceId:o,date:a},h.dialogModifyInvoice=!0},confirmModifyInvoice(){v.modifyInvoiceFormRef.value.validate((e=>{if(!e)return;const{invoiceId:a,date:o}=n(h.modifyInvoiceForm);(function(e){return C.post(I.INVOICE.modifyInvoiceDate,e)})({InvoiceNo:a,PostingDate:o}).then((()=>{r.success("操作成功"),h.dialogModifyInvoice=!1})).finally((()=>{u()}))}))}};return d((()=>e.getters.settings),(()=>{h.headersConfig=e.getters.settings[a.name]||h.headersConfig})),c((()=>{Promise.all([C.post(I.INVOICE.queryInvoiceProvider,{}).then((e=>{h.invoiceProviderOptions=e.Providers.map((e=>({label:e,value:e})))}))]).then((()=>{u()}))})),{state:h,...v,labelWidth:"90px",modifyInvoiceFormRules:{date:[{required:!0,message:"请选择账务日期",trigger:"change"}]},...f,headersShown:g}}}),N={class:"date-box"},D=b("查询"),k=b("修改"),w=m("div",{class:"title"},"编辑",-1),O={class:"center-footer"},_=b("取消"),E=b("确认");e("default",P(M,[["render",function(e,a,o,t,i,l){const n=s("el-date-picker"),r=s("el-input"),d=s("el-option"),c=s("el-select"),b=s("el-button"),C=s("styled-search"),I=s("el-table-column"),P=s("styled-table"),S=s("styled-pagination"),V=s("el-form-item"),M=s("el-form"),F=s("el-dialog");return u(),p(h,null,[m(C,{"hide-search-more":""},{"styled-search-left":g((()=>[m("div",N,[m(n,{modelValue:e.state.searchParam.dateRange,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.searchParam.dateRange=a),type:"daterange","value-format":"YYYY-MM-DD","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),m(r,{modelValue:e.state.searchParam.invoiceNumber,"onUpdate:modelValue":a[2]||(a[2]=a=>e.state.searchParam.invoiceNumber=a),placeholder:"请输入发票号",clearable:"",onKeydown:v(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),m(c,{modelValue:e.state.searchParam.invoiceProvider,"onUpdate:modelValue":a[3]||(a[3]=a=>e.state.searchParam.invoiceProvider=a),placeholder:"请选择供应商",clearable:"",onChange:e.handleSearch},{default:g((()=>[(u(!0),p(h,null,f(e.state.invoiceProviderOptions,((e,a)=>(u(),p(d,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),m(b,{type:"primary",class:"search",onClick:e.handleSearch},{default:g((()=>[D])),_:1},8,["onClick"])])),_:1}),m(P,{loading:e.state.loading,setting:"",multiple:"",data:e.state.tableData,onChangeMultiple:e.handleChangeMultiple,onClickSetting:e.handleClickSetting},{"table-columns":g((()=>[(u(!0),p(h,null,f(e.headersShown,((a,o)=>(u(),p(I,{"show-overflow-tooltip":"",key:o,prop:a.prop,label:a.label,"min-width":e.calcHeaderMinWidth(a)},{header:g((e=>[m("span",null,y(e.column.label),1)])),default:g((e=>[m("span",null,y(e.row[a.prop]),1)])),_:2},1032,["prop","label","min-width"])))),128)),m(I,{label:"操作","min-width":100,fixed:"right"},{default:g((a=>[m(b,{class:"modify",type:"text",onClick:o=>e.handleModify(a.row)},{default:g((()=>[k])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["loading","data","onChangeMultiple","onClickSetting"]),m(S,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":a[4]||(a[4]=a=>e.state.pagination.currentPage=a),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":a[5]||(a[5]=a=>e.state.pagination.pageSize=a),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"]),m(F,{width:"516px",modelValue:e.state.dialogModifyInvoice,"onUpdate:modelValue":a[8]||(a[8]=a=>e.state.dialogModifyInvoice=a)},{title:g((()=>[w])),footer:g((()=>[m("div",O,[m(b,{onClick:a[7]||(a[7]=a=>e.state.modifyDialog=!1),class:"cancel"},{default:g((()=>[_])),_:1}),m(b,{type:"primary",onClick:e.confirmModifyInvoice,class:"confirm"},{default:g((()=>[E])),_:1},8,["onClick"])])])),default:g((()=>[m(M,{ref:"modifyInvoiceFormRef",model:e.state.modifyInvoiceForm,rules:e.modifyInvoiceFormRules},{default:g((()=>[m(V,{label:"账务日期","label-width":e.labelWidth,prop:"date"},{default:g((()=>[m(n,{modelValue:e.state.modifyInvoiceForm.date,"onUpdate:modelValue":a[6]||(a[6]=a=>e.state.modifyInvoiceForm.date=a),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择日期"},null,8,["modelValue"])])),_:1},8,["label-width"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])],64)}]]))}}}));
