System.register(["./index-legacy.acc39ef9.js","../vendors/element-plus-legacy-e48d1ae3.js"],(function(e){"use strict";var a,l,t,o,i,r,n,d,c,s,p,u,m,g,h,b,v,y,N,P;return{setters:[function(e){a=e.r,l=e.U,t=e._,o=e.b,i=e.u},function(e){r=e.d,n=e.r,d=e.i,c=e.S,s=e.O,p=e.E,u=e.m,m=e.q,g=e.y,h=e.G,b=e.F,v=e.A,y=e.z,N=e.I,P=e.C}],execute:function(){const f=r({setup(){const e=o(),t=i(),r={FROM_WHERE:"/invoiceverify",headersConfig:[{label:"发票单号",prop:"invoiceNo"},{label:"验收明细编号",prop:"acceptNo"},{label:"物料名称",prop:"materialName"},{label:"采购单价",prop:"purchasePrice"},{label:"交货量",prop:"deliveryAmount"},{label:"请购单位",prop:"purchaseUnit"},{label:"采购金额",prop:"totalMoney"},{label:"交货日期",prop:"deliveryDate"},{label:"开票公司名称",prop:"invoiceCompany"},{label:"批次号",prop:"batchNo"},{label:"效期",prop:"validity",width:100}]},p=()=>{g.dialogLoading=!0;const{materialName:e,deliveryNo:t}=N(g.dialogSearchParam),{pageSize:o,currentPage:i}=N(g.dialogPagination);(function(e){return a.post(l.INVOICE.queryInvoiceDelivery,e)})({SearchWord:e,DeliverOrderId:t,PageNo:i,RecordPerPage:o}).then((e=>{g.dialogPagination.total=e.TotalRecordCount,u(e.DeliverOrders)})).finally((()=>{g.dialogLoading=!1}))},u=e=>{console.log(e),g.dialogTableData=e.map((e=>{const{dOrder:a,material:l}=e,{name:t}=l,{INVOICENO:o,DPACKUNIT:i,INVOICETITLE:r,PONO:n,SODATE:d,ENDDATE:c,SONO:s,DQTY:p,INVOICEAMT:u,DTAXPRC:m}=a;return{invoiceNo:o,acceptNo:s,materialName:t,purchasePrice:m,deliveryAmount:p,totalMoney:u,deliveryDate:d.replace("T"," "),deliveryNo:"",purchaseUnit:i,invoiceCompany:r,deliveryCompany:"",batchNo:n,validity:c.substr(0,10)}}))},m=e=>{e&&(g.pagination.currentPage=1),p()},g=n({searchParam:{invoiceNumber:"",date:""},tableData:[],headersConfig:[{label:"发票号",prop:"invoiceNumber"},{label:"发票编号",prop:"invoiceSerialNumber"},{label:"发票金额",prop:"invoiceMoney"},{label:"状态",prop:"status"},{label:"供应商",prop:"provider"},{label:"开票时间",prop:"invoiceCreateTime"}],blendDataDialog:!1,dialogSearchParam:{materialName:"",deliveryNo:""},dialogPagination:{currentPage:1,total:0,pageSize:30},dialogTableData:[],dialogLoading:!1}),h={calcHeaderWidth:d("calcHeaderMinWidth"),handleBlendData(){g.blendDataDialog=!0,p()},handleConfirmVerify(){(function(e){return a.post(l.INVOICE.verifyInvoice,e)})({InvoiceNo:g.searchParam.invoiceNumber,VerifyDate:g.searchParam.date}).then((e=>{c.success("操作成功"),t.push(r.FROM_WHERE)}))},handleGoBack(){t.go(-1)},handlePaginationChange(){m(!1)},handleDialogSearch(){m(!0)}};return s((()=>{let o=e.params.chosenTableData;if(!o)return t.push(r.FROM_WHERE);if(o=JSON.parse(o),!o.length)return t.push(r.FROM_WHERE);const i=o[0].invoiceNumber;g.searchParam.invoiceNumber=i,function(e){return a.post(l.INVOICE.queryInvoiceDetail,e)}({InvoiceNo:i}).then((e=>{var a;a=e.invoices,g.tableData=a.map((e=>{const{INVOICEDATE:a,INVOICEAMT:l,INVOICENO:t,INVOICECODE:o,VerifyStatus:i,ProviderName:r}=e;return{invoiceNumber:t,invoiceSerialNumber:o,invoiceMoney:l,status:i?"已核销":"待核销",provider:r,invoiceCreateTime:a.substr(0,10)}}))}))})),{state:g,...r,...h}}}),C={class:"date-box"},D=P("勾兑数据"),I=P("确定核销"),V=P("返回选择"),O=g("div",{class:"title"},"选择验收单",-1),E={class:"body"},S={class:"dialog-search-area"},T=P("查询"),_={class:"right-footer"};e("default",t(f,[["render",function(e,a,l,t,o,i){const r=p("el-input"),n=p("el-date-picker"),d=p("el-button"),c=p("styled-search"),s=p("el-table-column"),N=p("styled-table"),P=p("dialog-table"),f=p("styled-pagination"),k=p("el-dialog");return u(),m(b,null,[g(c,{"hide-search-more":""},{"styled-search-left":h((()=>[g(r,{modelValue:e.state.searchParam.invoiceNumber,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.searchParam.invoiceNumber=a),placeholder:"请输入发票号",clearable:"",disabled:""},null,8,["modelValue"]),g("div",C,[g(n,{modelValue:e.state.searchParam.date,"onUpdate:modelValue":a[2]||(a[2]=a=>e.state.searchParam.date=a),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择日期"},null,8,["modelValue"])])])),"styled-search-right":h((()=>[g(d,{type:"primary",class:"search",onClick:e.handleBlendData},{default:h((()=>[D])),_:1},8,["onClick"]),g(d,{type:"success",class:"export",disabled:!e.state.searchParam.date,onClick:e.handleConfirmVerify},{default:h((()=>[I])),_:1},8,["disabled","onClick"]),g(d,{type:"primary",plain:"",onClick:e.handleGoBack},{default:h((()=>[V])),_:1},8,["onClick"])])),_:1}),g(N,{data:e.state.tableData},{"table-columns":h((()=>[(u(!0),m(b,null,v(e.state.headersConfig,((a,l)=>(u(),m(s,{"show-overflow-tooltip":"",key:l,prop:a.prop,label:a.label,"min-width":e.calcHeaderWidth(a,l)},{header:h((e=>[g("span",null,y(e.column.label),1)])),default:h((e=>[g("span",null,y(e.row[a.prop]),1)])),_:2},1032,["prop","label","min-width"])))),128))])),_:1},8,["data"]),g(k,{"custom-class":"blend-data",width:"90%",modelValue:e.state.blendDataDialog,"onUpdate:modelValue":a[7]||(a[7]=a=>e.state.blendDataDialog=a)},{title:h((()=>[O])),footer:h((()=>[g("div",_,[g(f,{total:e.state.dialogPagination.total,"current-page":e.state.dialogPagination.currentPage,"onUpdate:current-page":a[5]||(a[5]=a=>e.state.dialogPagination.currentPage=a),"page-size":e.state.dialogPagination.pageSize,"onUpdate:page-size":a[6]||(a[6]=a=>e.state.dialogPagination.pageSize=a),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"])])])),default:h((()=>[g("div",E,[g("div",S,[g(r,{modelValue:e.state.dialogSearchParam.materialName,"onUpdate:modelValue":a[3]||(a[3]=a=>e.state.dialogSearchParam.materialName=a),placeholder:"请输入物料名称、简称、或院内码",clearable:""},null,8,["modelValue"]),g(r,{modelValue:e.state.dialogSearchParam.deliveryNo,"onUpdate:modelValue":a[4]||(a[4]=a=>e.state.dialogSearchParam.deliveryNo=a),placeholder:"请输入SAP交货单号",clearable:""},null,8,["modelValue"]),g(d,{type:"primary",class:"search",onClick:e.handleDialogSearch},{default:h((()=>[T])),_:1},8,["onClick"])]),g(P,{loading:e.state.dialogLoading,data:e.state.dialogTableData,height:600},{"table-columns":h((()=>[(u(!0),m(b,null,v(e.headersConfig,((a,l)=>(u(),m(s,{"show-overflow-tooltip":"",key:l,prop:a.prop,label:a.label,"min-width":e.calcHeaderWidth(a,l)},{header:h((e=>[g("span",null,y(e.column.label),1)])),default:h((e=>[g("span",null,y(e.row[a.prop]),1)])),_:2},1032,["prop","label","min-width"])))),128))])),_:1},8,["loading","data"])])])),_:1},8,["modelValue"])],64)}]]))}}}));
