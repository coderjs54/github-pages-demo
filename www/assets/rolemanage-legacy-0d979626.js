System.register(["../vendors/element-plus-legacy-e48d1ae3.js","./index-legacy.acc39ef9.js","./menu-legacy-1adae44a.js","./tip-legacy-d18ff986.js"],(function(e){"use strict";var l,a,o,t,d,r,i,s,n,u,m,c,f,p,R,y,h,b,g,F,k,w,C,V,_;return{setters:[function(e){l=e.d,a=e.a,o=e.r,t=e.c,d=e.i,r=e.I,i=e.S,s=e.o,n=e.w,u=e.E,m=e.m,c=e.q,f=e.y,p=e.G,R=e.N,y=e.F,h=e.A,b=e.z,g=e.C},function(e){F=e.r,k=e.U,w=e._,C=e.d},function(e){V=e.m},function(e){_=e._}],execute:function(){const A=l({setup(){const e=C(),l=(e,l,a)=>{l.length?a():a("请选择角色权限!")},u=()=>{p.loading=!0,function(e){return F.post(k.ROLE.queryRole,{search_word:e})}(p.searchVal).then((e=>{m(e.roles)})).finally((()=>{p.loading=!1}))},m=e=>{p.tableData=e.map((e=>{let{id:l,name:a,mark:o,function_list:t}=e;return{server:e,number:l,role:a,module:o||"这是角色标识",menuList:t.slice(1,-1).split(",").map((e=>Number(e)))}}))},c={addFormRef:a(null),modifyFormRef:a(null),addTreeRef:a(null),modifyTreeRef:a(null)},f={labelWidth:"110px",addRoleFormRules:{module:[{required:!0,message:"请输入模块标识",trigger:"blur"}],role:[{required:!0,message:"请输入角色名称",trigger:"blur"}],menuList:[{required:!0,message:"请选择角色权限！",trigger:"blur"},{validator:l,trigger:"blur"}]},modifyRoleFormRules:{module:[{required:!0,message:"请输入模块标识",trigger:"blur"}],role:[{required:!0,message:"请输入角色名称",trigger:"blur"}],menuList:[{required:!0,message:"请选择角色权限！",trigger:"blur"},{validator:l,trigger:"blur"}]}},p=o({loading:!1,RoleIds:t((()=>e.getters.RoleIds)),searchVal:"",dialogAddRole:!1,dialogModifyRole:!1,dialogDeleteRole:!1,deleteRoleData:{id:"",role:""},tableData:[],headersConfig:[{label:"角色编号",prop:"number"},{label:"角色名称",prop:"role"},{label:"模块标识",prop:"module"}],addRoleForm:{role:"",module:"",dangerInspector:!1,buyAToB:!1,menuList:[]},modifyRoleForm:{id:"",role:"",module:"",dangerInspector:!1,buyAToB:!1,menuList:[],functions:[]},treeData:{data:V,defaultProps:{children:"submenus",label:"title"},defaultOpenedKeys:[]}}),R={calcHeaderMinWidth:d("calcHeaderMinWidth"),handleSearch:u,addRole(){p.dialogAddRole=!0},cancelAddRole(){p.dialogAddRole=!1},cancelModifyRole(){p.dialogModifyRole=!1},modifyRole(e){const{CanSeeBuyAToB:l,CanSeeCloneNumber:a,MenuList:o,function_list:t,id:d,isHazardousChemicalAdmin:i,mark:s,name:n}=r(e.server);p.modifyRoleForm={id:d,role:n,module:s,dangerInspector:i,buyAToB:l,menuList:null==o?void 0:o.substring(1,o.length).split(","),functions:t},p.dialogModifyRole=!0},deleteRole(e){p.dialogDeleteRole=!0;const{number:l,role:a}=r(e);p.deleteRoleData={id:l,role:a}},confirmDeleteRole(){const{id:e}=r(p.deleteRoleData);(function(e){return F.post(k.ROLE.deleteRole,{id:e})})(e).then((()=>{i.success("操作成功"),u()})).finally((()=>{p.dialogDeleteRole=!1}))},confirmAddRole(){p.addRoleForm.menuList=c.addTreeRef.value.getCheckedKeys().filter((e=>void 0!==e)),c.addFormRef.value.validate((e=>{if(!e)return;let{role:l,module:a,dangerInspector:o,buyAToB:t,menuList:d}=r(p.addRoleForm);(function(e){return F.post(k.ROLE.addRole,e)})({name:l,mark:a,IsHazarousChemicalAdmin:o,CanSeeBuyAToB:t,CanSeeCloneNumber:!0,functions:`[${p.RoleIds.join(",")}]`,MenuList:`[${d.join(",")}]`}).then((e=>{i.success("操作成功"),u()})).finally((()=>{p.dialogAddRole=!1}))}))},confirmModifyRole(){p.modifyRoleForm.menuList=c.modifyTreeRef.value.getCheckedKeys().filter((e=>void 0!==e)),c.modifyFormRef.value.validate((e=>{if(!e)return;let{buyAToB:l,dangerInspector:a,functions:o,id:t,menuList:d,module:s,role:n}=r(p.modifyRoleForm);(function(e){return F.post(k.ROLE.modifyRole,e)})({id:t,name:n,mark:s,functions:`[${p.RoleIds.join(",")}]`,IsHazarousChemicalAdmin:a,CanSeeBuyAToB:l,CanSeeCloneNumber:!0,MenuList:`[${d.join(",")}]`}).then((()=>{i.success("操作成功"),u()})).finally((()=>{p.dialogModifyRole=!1}))}))}};return s((()=>{u()})),n((()=>p.dialogAddRole),(e=>{e||(p.addRoleForm={role:"",module:"",dangerInspector:!1,buyAToB:!1,menuList:[]},c.addTreeRef.value.setCheckedKeys([]),c.addFormRef.value.resetFields())})),n((()=>p.dialogModifyRole),(e=>{e||(p.modifyRoleForm={id:"",role:"",module:"",dangerInspector:!1,buyAToB:!1,menuList:[],functions:[]},c.modifyTreeRef.value.setCheckedKeys([]),c.modifyFormRef.value.resetFields())})),n((()=>p.dialogDeleteRole),(e=>{e||(p.deleteRoleData={id:"",role:""})})),{state:p,...c,...R,...f}}}),v=g("查询"),D=g("新增"),L={key:1},T=g("编辑"),B=g("删除"),x=f("div",{class:"title"},"新增角色",-1),I={class:"center-footer"},M=g("取消"),W=g("确认"),U=f("div",{class:"title"},"编辑角色",-1),S={class:"center-footer"},K=g("取消"),j=g("确认"),q=f("div",{class:"title"},"提示",-1),O={class:"tip-body"},H=f("img",{src:_,alt:""},null,-1),E=g("确认要将名为"),N={class:"item-name"},z=g("的角色"),$=f("span",{class:"highlight-text"},"删除",-1),P=g("吗?"),G={class:"right-footer"},J=g("取消"),Q=g("确定");e("default",w(A,[["render",function(e,l,a,o,t,d){const r=u("el-input"),i=u("el-button"),s=u("styled-search"),n=u("el-tag"),F=u("el-table-column"),k=u("styled-table"),w=u("el-form-item"),C=u("el-switch"),V=u("el-tooltip"),_=u("el-tree"),A=u("el-form"),X=u("el-dialog");return m(),c(y,null,[f(s,{"hide-search-more":""},{"styled-search-left":p((()=>[f(r,{modelValue:e.state.searchVal,"onUpdate:modelValue":l[1]||(l[1]=l=>e.state.searchVal=l),placeholder:"请输入角色名称",clearable:"",onKeydown:R(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),f(i,{type:"primary",class:"search",onClick:e.handleSearch},{default:p((()=>[v])),_:1},8,["onClick"])])),"styled-search-right":p((()=>[f(i,{type:"success",icon:"el-icon-plus",class:"export",onClick:e.addRole},{default:p((()=>[D])),_:1},8,["onClick"])])),_:1}),f(k,{loading:e.state.loading,data:e.state.tableData},{"table-columns":p((()=>[(m(!0),c(y,null,h(e.state.headersConfig,((l,a)=>(m(),c(F,{"show-overflow-tooltip":"",key:a,prop:l.prop,label:l.label,"min-width":e.calcHeaderMinWidth(l,a)},{header:p((e=>[f("span",null,b(e.column.label),1)])),default:p((e=>["status"===l.prop?(m(),c(n,{key:0,class:0===e.row.status?"withdraw":"normal"},{default:p((()=>[g(b(0===e.row.status?"注销":"正常"),1)])),_:2},1032,["class"])):(m(),c("span",L,b(e.row[l.prop]),1))])),_:2},1032,["prop","label","min-width"])))),128)),f(F,{label:"操作",fixed:"right"},{default:p((l=>[f(i,{type:"text",class:"modify",onClick:a=>e.modifyRole(l.row)},{default:p((()=>[T])),_:2},1032,["onClick"]),f(i,{type:"text",class:"delete",onClick:a=>e.deleteRole(l.row)},{default:p((()=>[B])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["loading","data"]),f(X,{width:"516px",modelValue:e.state.dialogAddRole,"onUpdate:modelValue":l[6]||(l[6]=l=>e.state.dialogAddRole=l)},{title:p((()=>[x])),footer:p((()=>[f("div",I,[f(i,{onClick:e.cancelAddRole,class:"cancel"},{default:p((()=>[M])),_:1},8,["onClick"]),f(i,{type:"primary",onClick:e.confirmAddRole,class:"confirm"},{default:p((()=>[W])),_:1},8,["onClick"])])])),default:p((()=>[f(A,{model:e.state.addRoleForm,rules:e.addRoleFormRules,ref:"addFormRef"},{default:p((()=>[f(w,{label:"角色名称","label-width":e.labelWidth,prop:"role"},{default:p((()=>[f(r,{modelValue:e.state.addRoleForm.role,"onUpdate:modelValue":l[2]||(l[2]=l=>e.state.addRoleForm.role=l),placeholder:"请输入角色名称",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),f(w,{label:"模块标识","label-width":e.labelWidth,prop:"module"},{default:p((()=>[f(r,{modelValue:e.state.addRoleForm.module,"onUpdate:modelValue":l[3]||(l[3]=l=>e.state.addRoleForm.module=l),placeholder:"请输入模块标识",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),f(w,{class:"switch-item",label:"危险品见证人","label-width":e.labelWidth},{default:p((()=>[f(V,{class:"item",effect:"dark",content:"选中后该角色的用户可以作为危险品见证人",placement:"right-start"},{default:p((()=>[f(C,{modelValue:e.state.addRoleForm.dangerInspector,"onUpdate:modelValue":l[4]||(l[4]=l=>e.state.addRoleForm.dangerInspector=l),"active-color":"#3C92FFFF"},null,8,["modelValue"])])),_:1})])),_:1},8,["label-width"]),f(w,{class:"switch-item",label:"买A换B订单","label-width":e.labelWidth},{default:p((()=>[f(V,{class:"item",effect:"dark",content:"选中后该角色的用户可以看到买A换B的订单信息",placement:"right-start"},{default:p((()=>[f(C,{modelValue:e.state.addRoleForm.buyAToB,"onUpdate:modelValue":l[5]||(l[5]=l=>e.state.addRoleForm.buyAToB=l),"active-color":"#3C92FFFF"},null,8,["modelValue"])])),_:1})])),_:1},8,["label-width"]),f(w,{label:"权限控制","label-width":e.labelWidth,prop:"menuList"},{default:p((()=>[f(_,{style:{"margin-top":"8px"},ref:"addTreeRef",data:e.state.treeData.data,props:e.state.treeData.defaultProps,"default-expanded-keys":e.state.treeData.defaultOpenedKeys,"node-key":"id","show-checkbox":""},null,8,["data","props","default-expanded-keys"])])),_:1},8,["label-width"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),f(X,{width:"516px",modelValue:e.state.dialogModifyRole,"onUpdate:modelValue":l[11]||(l[11]=l=>e.state.dialogModifyRole=l),"destroy-on-close":""},{title:p((()=>[U])),footer:p((()=>[f("div",S,[f(i,{onClick:e.cancelModifyRole,class:"cancel"},{default:p((()=>[K])),_:1},8,["onClick"]),f(i,{type:"primary",onClick:e.confirmModifyRole,class:"confirm"},{default:p((()=>[j])),_:1},8,["onClick"])])])),default:p((()=>[f(A,{model:e.state.modifyRoleForm,rules:e.modifyRoleFormRules,ref:"modifyFormRef"},{default:p((()=>[f(w,{label:"角色名称","label-width":e.labelWidth,prop:"role"},{default:p((()=>[f(r,{modelValue:e.state.modifyRoleForm.role,"onUpdate:modelValue":l[7]||(l[7]=l=>e.state.modifyRoleForm.role=l),placeholder:"请输入角色名称",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),f(w,{label:"模块标识","label-width":e.labelWidth,prop:"module"},{default:p((()=>[f(r,{modelValue:e.state.modifyRoleForm.module,"onUpdate:modelValue":l[8]||(l[8]=l=>e.state.modifyRoleForm.module=l),placeholder:"请输入模块标识",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),f(w,{class:"switch-item",label:"危险品见证人","label-width":e.labelWidth},{default:p((()=>[f(V,{class:"item",effect:"dark",content:"选中后该角色的用户可以作为危险品见证人",placement:"right-start"},{default:p((()=>[f(C,{modelValue:e.state.modifyRoleForm.dangerInspector,"onUpdate:modelValue":l[9]||(l[9]=l=>e.state.modifyRoleForm.dangerInspector=l),"active-color":"#3C92FFFF"},null,8,["modelValue"])])),_:1})])),_:1},8,["label-width"]),f(w,{class:"switch-item",label:"买A换B订单","label-width":e.labelWidth},{default:p((()=>[f(V,{class:"item",effect:"dark",content:"选中后该角色的用户可以看到买A换B的订单信息",placement:"right-start"},{default:p((()=>[f(C,{modelValue:e.state.modifyRoleForm.buyAToB,"onUpdate:modelValue":l[10]||(l[10]=l=>e.state.modifyRoleForm.buyAToB=l),"active-color":"#3C92FFFF"},null,8,["modelValue"])])),_:1})])),_:1},8,["label-width"]),f(w,{label:"权限控制","label-width":e.labelWidth,prop:"menuList"},{default:p((()=>[f(_,{style:{"margin-top":"8px"},ref:"modifyTreeRef",data:e.state.treeData.data,props:e.state.treeData.defaultProps,"default-checked-keys":e.state.modifyRoleForm.menuList,"default-expanded-keys":e.state.treeData.defaultOpenedKeys,"node-key":"id","show-checkbox":""},null,8,["data","props","default-checked-keys","default-expanded-keys"])])),_:1},8,["label-width"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),f(X,{width:"466px",modelValue:e.state.dialogDeleteRole,"onUpdate:modelValue":l[13]||(l[13]=l=>e.state.dialogDeleteRole=l)},{title:p((()=>[q])),footer:p((()=>[f("div",G,[f(i,{onClick:l[12]||(l[12]=l=>e.state.dialogDeleteRole=!1),class:"cancel"},{default:p((()=>[J])),_:1}),f(i,{type:"primary",onClick:e.confirmDeleteRole,class:"confirm"},{default:p((()=>[Q])),_:1},8,["onClick"])])])),default:p((()=>[f("div",O,[H,f("span",null,[E,f("span",N,b(e.state.deleteRoleData.role),1),z,$,P])])])),_:1},8,["modelValue"])],64)}]]))}}}));
