System.register(["../vendors/element-plus-legacy-e48d1ae3.js","./index-legacy.acc39ef9.js","./uploadrequest-legacy-2abb266e.js","./concurrent-legacy-5288d5cc.js","./department-legacy-7e39a566.js","./index-legacy-7e7197cb.js","./tip-legacy-d18ff986.js"],(function(e){"use strict";var l,a,t,n,o,d,i,r,s,m,u,c,p,g,b,h,f,_,y,D,V,w,F,M,A,k,C,U,v;return{setters:[function(e){l=e.d,a=e.i,t=e.a,n=e.r,o=e.c,d=e.I,i=e.S,r=e.o,s=e.w,m=e.E,u=e.m,c=e.q,p=e.y,g=e.G,b=e.N,h=e.F,f=e.A,_=e.z,y=e.C},function(e){D=e.r,V=e.U,w=e._,F=e.d,M=e.S},function(e){A=e.r},function(e){k=e.C},function(e){C=e.d},function(e){U=e.u},function(e){v=e._}],execute:function(){function S(e){const l=new FormData;return l.set("MultipartFile",e),A.post(V.INSTRUMENT.batchAddInstrument,l,{headers:{"Content-Type":"multipart/form-data"}})}function R(e){return D.post(V.INSTRUMENT.deleteInstrument,{id:e})}const q=l({setup(){const e=F(),l=a("singleUpload"),m=a("downloadTemplate"),u=()=>{g.loading=!0,function(e="",l){return D.post(V.INSTRUMENT.queryInstrument,{search_word:e,status:l})}(g.searchVal,g.filterVal).then((e=>{c(e.instruments)})).finally((()=>{g.loading=!1}))},c=e=>{g.tableData=e.map((e=>{let{id:l,english_name:a,chinese_name:t,serial_no:n,lab_no:o,status:d,lis_code:i,memo:r,DepartmentOwners:s,brand_id:m,status_change_time:u,status_change_reason:c}=e;return{id:l,english_name:a,chinese_name:t,lis_code:i,status:d,company_number:n,laboratory_number:o,department:s,department_name:C(s).map((e=>g.departmentMap[e])).join(","),brand:m,brand_name:g.brandMap[m]||"品牌不存在，可能是被删除了",remarks:r,toggle_time:u.replace("T"," "),toggle_reason:c}}))},p={styledUploadRef:t(null),singleAddFormRef:t(null),singleModifyFormRef:t(null)},g=n({loading:!1,uploading:!1,searchVal:"",filterVal:"1",tableData:[],headersConfig:[{label:"序号",prop:"id"},{label:"出厂编号",prop:"company_number"},{label:"仪器英文名",prop:"english_name"},{label:"仪器中文名",prop:"chinese_name"},{label:"实验室编号",prop:"laboratory_number"},{label:"部门名称",prop:"department_name"},{label:"品牌名称",prop:"brand_name"},{label:"lis码",prop:"lis_code"},{label:"状态",prop:"status"},{label:"停启时间",prop:"toggle_time"},{label:"停启原因",prop:"toggle_reason"},{label:"备注",prop:"remarks"}],multipleSelection:[],singleAddDialog:!1,batchAddDialog:!1,singleDelDialog:!1,batchDelDialog:!1,singleModifyDialog:!1,singleAddForm:{company_number:"",english_name:"",chinese_name:"",laboratory_number:"",department:"",brand:"",lis_code:"",remarks:"",status:!0},singleModifyForm:{id:"",company_number:"",english_name:"",chinese_name:"",laboratory_number:"",department:"",brand:"",lis_code:"",remarks:"",status:!0},singleDelDialogData:{id:"",chinese_name:""},batchDelDialogData:[],departmentOptions:[],brandOptions:o((()=>e.getters.brandOptions)),brandMap:o((()=>e.getters.brandIdMap)),departmentMap:{},batchDeleting:!1}),b={calcHeaderMinWidth:a("calcHeaderMinWidth"),handleChangeMultiple(e){g.multipleSelection=e},handleSearch(){u()},handleAdd(){g.singleAddDialog=!0},handleBatchAdd(){g.batchAddDialog=!0},handleModify(e){g.singleModifyDialog=!0;const{id:l,company_number:a,english_name:t,chinese_name:n,laboratory_number:o,department:i,brand:r,lis_code:s,status:m,remarks:u}=d(e),c=C(i);g.singleModifyForm={id:l,company_number:a,english_name:t,chinese_name:n,laboratory_number:o,department:c,brand:r,lis_code:s,status:m,remarks:u}},handleBatchDelete(){g.batchDelDialog=!0},handleSingleDelete(e){const{id:l,chinese_name:a}=d(e);g.singleDelDialogData={id:l,chinese_name:a},g.singleDelDialog=!0},confirmSingleAdd(){p.singleAddFormRef.value.validate((e=>{if(!e)return;let{company_number:l,english_name:a,chinese_name:t,laboratory_number:n,department:o,brand:r,lis_code:s,remarks:m,status:c}=d(g.singleAddForm);(function(e){return D.post(V.INSTRUMENT.addInstrument,e)})({serial_no:l,english_name:a,chinese_name:t,lab_no:n,brand_id:r,lis_code:s,status:c,DepartmentOwners:`|${o.map((e=>e.at(-1))).join("|")}|`,memo:m}).then((()=>{i.success("操作成功"),u(),U()})).finally((()=>{g.singleAddDialog=!1}))}))},confirmSingleModify(){p.singleModifyFormRef.value.validate((e=>{if(!e)return;const{id:l,company_number:a,english_name:t,chinese_name:n,laboratory_number:o,department:r,brand:s,lis_code:m,status:c,remarks:p}=d(g.singleModifyForm);(function(e){return D.post(V.INSTRUMENT.modifyInstrument,e)})({id:l,english_name:t,chinese_name:n,lis_code:m,status:c,serial_no:a,lab_no:o,brand_id:s,DepartmentOwners:`|${r.map((e=>Array.isArray(e)?e.at(-1):e)).join("|")}|`,memo:p}).then((()=>{i.success("操作成功"),u(),U()})).finally((()=>{g.singleModifyDialog=!1}))}))},handleDownloadTemplate(){m("Instrument")},handleUpload(e){g.uploading=!0,l(e,S).then((()=>{i.success("操作成功"),u(),U()})).finally((()=>{g.uploading=!1,g.batchAddDialog=!1}))},confirmSingleDel(){const{id:e}=d(g.singleDelDialogData);R(String(e)).then((()=>{i.success("操作成功"),u(),U()})).finally((()=>{g.singleDelDialog=!1}))},confirmBatchDel(){const e=g.multipleSelection.map((e=>e.id));g.batchDeleting=!0,function(e,l){const a=new k({concurrent:5,total:e.length,requestFunc:R});for(let t=0;t<e.length;t++)a.request(e[t],l)}(e,(l=>{g.batchDelDialog=!1;const a=l.filter((e=>e.success));a.length===e.length?i.success(`成功删除选中的${a.length}个仪器`):i.error(`成功删除选中的${a.length}个仪器，有${e.length-a.length}个删除失败`),u(),g.batchDeleting=!1}))}};return r((()=>{Promise.all([D.get(V.DEPARTMENT.queryDepartment).then((e=>{g.departmentMap=Object.fromEntries(e.departments.map((e=>[e.id,e.name]))),g.departmentOptions=M(e.departments)}))]).then((()=>{u()}))})),s((()=>g.singleAddDialog),(e=>{e||(g.singleAddForm={company_number:"",english_name:"",chinese_name:"",laboratory_number:"",department:"",brand:"",lis_code:"",remarks:"",status:!0},p.singleAddFormRef.value.resetFields())})),s((()=>g.singleDelDialog),(e=>{e||(g.singleDelDialogData={id:"",chinese_name:""})})),s((()=>g.singleModifyDialog),(e=>{e||(g.singleModifyForm={id:"",company_number:"",english_name:"",chinese_name:"",laboratory_number:"",department:"",brand:"",lis_code:"",remarks:"",status:!1},p.singleModifyFormRef.value.resetFields())})),s((()=>g.batchAddDialog),(e=>{e||p.styledUploadRef.value.clearFiles()})),{state:g,...p,...b,labelWidth:"100px",singAddFormRules:{company_number:[{required:!0,message:"请选择出厂编号",trigger:"change"}],english_name:[{required:!0,message:"请输入仪器英文名",trigger:"blur"}],chinese_name:[{required:!0,message:"请输入仪器中文名",trigger:"blur"}],laboratory_number:[{required:!0,message:"请输入实验室编号",trigger:"blur"}],department:[{required:!0,message:"请选择部门",trigger:"change"}],brand:[{required:!0,message:"请选择品牌",trigger:"change"}],lis_code:[{required:!0,message:"请输入lis码",trigger:"blur"}]},singleModifyFormRules:{company_number:[{required:!0,message:"请选择出厂编号",trigger:"change"}],english_name:[{required:!0,message:"请输入仪器英文名",trigger:"blur"}],chinese_name:[{required:!0,message:"请输入仪器中文名",trigger:"blur"}],laboratory_number:[{required:!0,message:"请输入实验室编号",trigger:"blur"}],department:[{required:!0,message:"请选择部门",trigger:"change"}],brand:[{required:!0,message:"请选择品牌",trigger:"change"}],lis_code:[{required:!0,message:"请输入lis码",trigger:"blur"}]}}}}),W=y("查询"),T=y("新增"),x=y("批量新增"),I=y("删除选择"),N={key:1},O=y("编辑"),j=y("删除"),E=p("div",{class:"title"},"新增仪器",-1),B={class:"center-footer"},$=y("取消"),H=y("确认"),K=p("div",{class:"title"},"编辑仪器",-1),P={class:"center-footer"},z=y("取消"),G=y("确认"),J=p("div",{class:"title"},"批量导入",-1),L=p("div",{class:"title"},"提示",-1),Q={class:"tip-body"},X=p("img",{src:v,alt:""},null,-1),Y=y("确认要将名为"),Z={class:"item-name"},ee=y("的仪器"),le=p("span",{class:"highlight-text"},"删除",-1),ae=y("吗?"),te={class:"right-footer"},ne=y("取消"),oe=y("确定"),de=p("div",{class:"title"},"提示",-1),ie={class:"tip-body"},re=p("img",{src:v,alt:""},null,-1),se=y("确认要将选中的"),me={class:"item-name"},ue=y("个仪器"),ce=p("span",{class:"highlight-text"},"删除",-1),pe=y("吗?"),ge={class:"right-footer"},be=y("取消"),he=y("确定");e("default",w(q,[["render",function(e,l,a,t,n,o){const d=m("el-input"),i=m("el-option"),r=m("el-select"),s=m("el-button"),D=m("styled-search"),V=m("el-tag"),w=m("el-table-column"),F=m("styled-table"),M=m("el-form-item"),A=m("el-cascader"),k=m("el-form"),C=m("el-dialog"),U=m("styled-upload");return u(),c(h,null,[p(D,{"hide-search-more":""},{"styled-search-left":g((()=>[p(d,{modelValue:e.state.searchVal,"onUpdate:modelValue":l[1]||(l[1]=l=>e.state.searchVal=l),placeholder:"请输入仪器英文名称",clearable:"",onKeydown:b(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),p(r,{modelValue:e.state.filterVal,"onUpdate:modelValue":l[2]||(l[2]=l=>e.state.filterVal=l),placeholder:"请选择",onChange:e.handleSearch},{default:g((()=>[p(i,{label:"全部",value:"2"}),p(i,{label:"启用",value:"1"}),p(i,{label:"停用",value:"0"})])),_:1},8,["modelValue","onChange"]),p(s,{type:"primary",class:"search",onClick:e.handleSearch},{default:g((()=>[W])),_:1},8,["onClick"])])),"styled-search-right":g((()=>[p(s,{type:"success",icon:"el-icon-plus",class:"export",onClick:e.handleAdd},{default:g((()=>[T])),_:1},8,["onClick"]),p(s,{type:"success",class:"export",onClick:e.handleBatchAdd},{default:g((()=>[x])),_:1},8,["onClick"]),p(s,{type:"danger",disabled:0===e.state.multipleSelection.length,class:"delete",onClick:e.handleBatchDelete},{default:g((()=>[I])),_:1},8,["disabled","onClick"])])),_:1}),p(F,{loading:e.state.loading,multiple:"",data:e.state.tableData,onChangeMultiple:e.handleChangeMultiple},{"table-columns":g((()=>[(u(!0),c(h,null,f(e.state.headersConfig,((l,a)=>(u(),c(w,{"show-overflow-tooltip":"",key:a,prop:l.prop,label:l.label,"min-width":e.calcHeaderMinWidth(l,a)},{header:g((e=>[p("span",null,_(e.column.label),1)])),default:g((e=>["status"===l.prop?(u(),c(V,{key:0,class:e.row.status?"normal":"withdraw"},{default:g((()=>[y(_(e.row.status?"启用":"停用"),1)])),_:2},1032,["class"])):(u(),c("span",N,_(e.row[l.prop]),1))])),_:2},1032,["prop","label","min-width"])))),128)),p(w,{label:"操作",fixed:"right"},{default:g((l=>[p(s,{type:"text",class:"modify",onClick:a=>e.handleModify(l.row)},{default:g((()=>[O])),_:2},1032,["onClick"]),p(s,{type:"text",class:"delete",onClick:a=>e.handleSingleDelete(l.row)},{default:g((()=>[j])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["loading","data","onChangeMultiple"]),p(C,{width:"516px",modelValue:e.state.singleAddDialog,"onUpdate:modelValue":l[12]||(l[12]=l=>e.state.singleAddDialog=l)},{title:g((()=>[E])),footer:g((()=>[p("div",B,[p(s,{onClick:l[11]||(l[11]=l=>e.state.singleAddDialog=!1),class:"cancel"},{default:g((()=>[$])),_:1}),p(s,{type:"primary",onClick:e.confirmSingleAdd,class:"confirm"},{default:g((()=>[H])),_:1},8,["onClick"])])])),default:g((()=>[p(k,{model:e.state.singleAddForm,rules:e.singAddFormRules,ref:"singleAddFormRef"},{default:g((()=>[p(M,{label:"出厂编号","label-width":e.labelWidth,prop:"company_number"},{default:g((()=>[p(d,{modelValue:e.state.singleAddForm.company_number,"onUpdate:modelValue":l[3]||(l[3]=l=>e.state.singleAddForm.company_number=l),placeholder:"请输入出厂编号",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"仪器英文名","label-width":e.labelWidth,prop:"english_name"},{default:g((()=>[p(d,{modelValue:e.state.singleAddForm.english_name,"onUpdate:modelValue":l[4]||(l[4]=l=>e.state.singleAddForm.english_name=l),placeholder:"请输入仪器英文名",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"仪器中文名","label-width":e.labelWidth,prop:"chinese_name"},{default:g((()=>[p(d,{modelValue:e.state.singleAddForm.chinese_name,"onUpdate:modelValue":l[5]||(l[5]=l=>e.state.singleAddForm.chinese_name=l),placeholder:"请输入仪器中文名",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"实验室编号","label-width":e.labelWidth,prop:"laboratory_number"},{default:g((()=>[p(d,{modelValue:e.state.singleAddForm.laboratory_number,"onUpdate:modelValue":l[6]||(l[6]=l=>e.state.singleAddForm.laboratory_number=l),placeholder:"请输入实验室编号",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"部门","label-width":e.labelWidth,prop:"department"},{default:g((()=>[p(A,{modelValue:e.state.singleAddForm.department,"onUpdate:modelValue":l[7]||(l[7]=l=>e.state.singleAddForm.department=l),options:e.state.departmentOptions,"collapse-tags":"",props:{checkStrictly:!1,value:"id",label:"name",multiple:!0},placeholder:"请选择部门"},null,8,["modelValue","options"])])),_:1},8,["label-width"]),p(M,{label:"品牌","label-width":e.labelWidth,prop:"brand"},{default:g((()=>[p(r,{modelValue:e.state.singleAddForm.brand,"onUpdate:modelValue":l[8]||(l[8]=l=>e.state.singleAddForm.brand=l),placeholder:"请选择品牌",clearable:""},{default:g((()=>[(u(!0),c(h,null,f(e.state.brandOptions,(e=>(u(),c(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"lis码","label-width":e.labelWidth,prop:"lis_code"},{default:g((()=>[p(d,{modelValue:e.state.singleAddForm.lis_code,"onUpdate:modelValue":l[9]||(l[9]=l=>e.state.singleAddForm.lis_code=l),placeholder:"请输入lis码",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"备注","label-width":e.labelWidth},{default:g((()=>[p(d,{modelValue:e.state.singleAddForm.remarks,"onUpdate:modelValue":l[10]||(l[10]=l=>e.state.singleAddForm.remarks=l),placeholder:"请输入备注",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),p(C,{width:"516px",modelValue:e.state.singleModifyDialog,"onUpdate:modelValue":l[22]||(l[22]=l=>e.state.singleModifyDialog=l)},{title:g((()=>[K])),footer:g((()=>[p("div",P,[p(s,{onClick:l[21]||(l[21]=l=>e.state.singleModifyDialog=!1),class:"cancel"},{default:g((()=>[z])),_:1}),p(s,{type:"primary",onClick:e.confirmSingleModify,class:"confirm"},{default:g((()=>[G])),_:1},8,["onClick"])])])),default:g((()=>[p(k,{model:e.state.singleModifyForm,rules:e.singleModifyFormRules,ref:"singleModifyFormRef"},{default:g((()=>[p(M,{label:"出厂编号","label-width":e.labelWidth,prop:"company_number"},{default:g((()=>[p(d,{modelValue:e.state.singleModifyForm.company_number,"onUpdate:modelValue":l[13]||(l[13]=l=>e.state.singleModifyForm.company_number=l),placeholder:"请输入出厂编号",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"仪器英文名","label-width":e.labelWidth,prop:"english_name"},{default:g((()=>[p(d,{modelValue:e.state.singleModifyForm.english_name,"onUpdate:modelValue":l[14]||(l[14]=l=>e.state.singleModifyForm.english_name=l),placeholder:"请输入仪器英文名",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"仪器中文名","label-width":e.labelWidth,prop:"chinese_name"},{default:g((()=>[p(d,{modelValue:e.state.singleModifyForm.chinese_name,"onUpdate:modelValue":l[15]||(l[15]=l=>e.state.singleModifyForm.chinese_name=l),placeholder:"请输入仪器中文名",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"实验室编号","label-width":e.labelWidth,prop:"laboratory_number"},{default:g((()=>[p(d,{modelValue:e.state.singleModifyForm.laboratory_number,"onUpdate:modelValue":l[16]||(l[16]=l=>e.state.singleModifyForm.laboratory_number=l),placeholder:"请输入实验室编号",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"部门","label-width":e.labelWidth,prop:"department"},{default:g((()=>[p(A,{modelValue:e.state.singleModifyForm.department,"onUpdate:modelValue":l[17]||(l[17]=l=>e.state.singleModifyForm.department=l),options:e.state.departmentOptions,"collapse-tags":"",props:{checkStrictly:!1,value:"id",label:"name",multiple:!0},placeholder:"请选择部门"},null,8,["modelValue","options"])])),_:1},8,["label-width"]),p(M,{label:"品牌","label-width":e.labelWidth,prop:"brand"},{default:g((()=>[p(r,{modelValue:e.state.singleModifyForm.brand,"onUpdate:modelValue":l[18]||(l[18]=l=>e.state.singleModifyForm.brand=l),placeholder:"请选择品牌",clearable:""},{default:g((()=>[(u(!0),c(h,null,f(e.state.brandOptions,(e=>(u(),c(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"lis码","label-width":e.labelWidth,prop:"lis_code"},{default:g((()=>[p(d,{modelValue:e.state.singleModifyForm.lis_code,"onUpdate:modelValue":l[19]||(l[19]=l=>e.state.singleModifyForm.lis_code=l),placeholder:"请输入lis码",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"]),p(M,{label:"备注","label-width":e.labelWidth},{default:g((()=>[p(d,{modelValue:e.state.singleModifyForm.remarks,"onUpdate:modelValue":l[20]||(l[20]=l=>e.state.singleModifyForm.remarks=l),placeholder:"请输入备注",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1},8,["label-width"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),p(C,{width:"620px","custom-class":"upload",modelValue:e.state.batchAddDialog,"onUpdate:modelValue":l[23]||(l[23]=l=>e.state.batchAddDialog=l)},{title:g((()=>[J])),default:g((()=>[p(U,{ref:"styledUploadRef",uploading:e.state.uploading,"upload-label":"导入仪器","download-label":"下载仪器模版",onUploadFile:e.handleUpload,onDownloadTemplate:e.handleDownloadTemplate},null,8,["uploading","onUploadFile","onDownloadTemplate"])])),_:1},8,["modelValue"]),p(C,{width:"466px",modelValue:e.state.singleDelDialog,"onUpdate:modelValue":l[25]||(l[25]=l=>e.state.singleDelDialog=l)},{title:g((()=>[L])),footer:g((()=>[p("div",te,[p(s,{onClick:l[24]||(l[24]=l=>e.state.singleDelDialog=!1),class:"cancel"},{default:g((()=>[ne])),_:1}),p(s,{type:"primary",onClick:e.confirmSingleDel,class:"confirm"},{default:g((()=>[oe])),_:1},8,["onClick"])])])),default:g((()=>[p("div",Q,[X,p("span",null,[Y,p("span",Z,_(e.state.singleDelDialogData.chinese_name),1),ee,le,ae])])])),_:1},8,["modelValue"]),p(C,{width:"466px",modelValue:e.state.batchDelDialog,"onUpdate:modelValue":l[27]||(l[27]=l=>e.state.batchDelDialog=l)},{title:g((()=>[de])),footer:g((()=>[p("div",ge,[p(s,{onClick:l[26]||(l[26]=l=>e.state.batchDelDialog=!1),class:"cancel"},{default:g((()=>[be])),_:1}),p(s,{type:"primary",loading:e.state.batchDeleting,onClick:e.confirmBatchDel,class:"confirm"},{default:g((()=>[he])),_:1},8,["loading","onClick"])])])),default:g((()=>[p("div",ie,[re,p("span",null,[se,p("span",me,_(e.state.multipleSelection.length),1),ue,ce,pe])])])),_:1},8,["modelValue"])],64)}]]))}}}));
