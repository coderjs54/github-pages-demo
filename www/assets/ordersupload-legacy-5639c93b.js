System.register(["./index-legacy.acc39ef9.js","../vendors/element-plus-legacy-e48d1ae3.js"],(function(e){"use strict";var a,r,l,t,o,n,d,i,s,p,c,u,g,m,h,f,b,C,k,S,y,O,R;return{setters:[function(e){a=e.r,r=e.U,l=e._,t=e.d,o=e.b},function(e){n=e.d,d=e.i,i=e.c,s=e.a,p=e.r,c=e.I,u=e.S,g=e.w,m=e.o,h=e.E,f=e.m,b=e.q,C=e.y,k=e.G,S=e.C,y=e.z,O=e.F,R=e.A}],execute:function(){const _=n({setup(){const e=t(),l=o(),n=d("setTableHeaders"),h=()=>{S.loading=!0;const{pageSize:e,currentPage:l}=c(S.pagination),{searchWord:t}=c(S.searchParam);(function(e){return a.post(r.ORDER.queryOrder,e)})({search_word:t,IsHChemical:0,IsReceiveDeliverOrder:2,SendStatus:0,IsAccept:2,NeedPaging:!0,PageNum:l,RecordPerPage:e}).then((e=>{S.pagination.total=e.TotalRecordCount,f(e.AutoOrderInfo)})).finally((()=>{S.loading=!1}))},f=e=>{S.tableData=e.map((e=>{const{material:a,autostore:r}=e;return{...r,brandName:S.brandIdMap[a.brand_id]}}))},b=e=>{e&&(S.pagination.currentPage=1),h()},C=i((()=>S.headersConfig.filter((e=>!e.hidden)))),k={remarkFormRef:s(null)},S=p({loading:!1,searchParam:{searchWord:"",dateRange:"",diseaseType:""},pagination:{currentPage:1,total:0,pageSize:30},headersConfig:[{label:"序号",prop:"id"},{label:"订单编号",prop:"DJH"},{label:"审核日期",prop:"SHRQ"},{label:"物料名称",prop:"ZCMC"},{label:"规格型号",prop:"GGXH"},{label:"品牌",prop:"brandName"},{label:"单位",prop:"UNIT"},{label:"数量",prop:"AMOUNT"},{label:"申请部门名称",prop:"SQBMMC"},{label:"供货单位名称",prop:"GHDWMC"},{label:"记录生成日期",prop:"JLSCRQ"},{label:"制单人名称",prop:"ZDRMC"},{label:"备注",prop:"Remark"},{label:"买A换B",prop:"buy_a_to_b",hidden:!e.getters.buyAToB}],tableData:[],multipleSelection:[],brandIdMap:i((()=>e.getters.brandIdMap)),uploadOrderDialog:!1,remarkForm:{remark:""},orderIds:[]}),y={handleSearch(){b(!0)},calcHeaderWidth:d("calcHeaderMinWidth"),handleClickSetting(){n(S.headersConfig,(e=>{S.headersConfig=e}))},handleChangeMultiple(e){S.multipleSelection=e},handlePaginationChange(){b(!1)},handleUploadOrder(e){S.orderIds.push(e.id),S.uploadOrderDialog=!0},handleBatchUploadOrder(){S.orderIds=S.multipleSelection.map((e=>e.id)),S.uploadOrderDialog=!0},confirmUploadOrder(){const{remark:e}=c(S.remarkForm);(function(e){return a.post(r.ORDER.uploadOrder,e)})({AutoOrderList:S.orderIds.map((a=>({AutoOrderId:a,Remark:e})))}).then((e=>{u.success("操作成功"),h(),S.uploadOrderDialog=!1}))}};return g((()=>S.uploadOrderDialog),(e=>{e||(S.remarkForm={remark:""},k.remarkFormRef.value.clearValidate())})),g((()=>e.getters.settings),(()=>{S.headersConfig=e.getters.settings[l.name]||S.headersConfig})),m(h),{state:S,headersShown:C,...y,remarkFormRules:{remark:[{required:!0,message:"请输入订单备注信息",trigger:"blur"}]},...k}}}),D=S("查询"),P=S("上传订单"),I=C("div",{class:"title"},"添加备注",-1),M={class:"center-footer"},U=S("取消"),w=S("确认");e("default",l(_,[["render",function(e,a,r,l,t,o){const n=h("el-input"),d=h("el-button"),i=h("styled-search"),s=h("el-table-column"),p=h("styled-table"),c=h("styled-pagination"),u=h("el-form-item"),g=h("el-form"),m=h("el-dialog");return f(),b(O,null,[C(i,{"hide-search-more":""},{"styled-search-left":k((()=>[C(n,{modelValue:e.state.searchParam.searchWord,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.searchParam.searchWord=a),placeholder:"请输入查询关键字",clearable:""},null,8,["modelValue"]),C(d,{type:"primary",class:"search",onClick:e.handleSearch},{default:k((()=>[D])),_:1},8,["onClick"])])),"styled-search-right":k((()=>[C(d,{type:"success",class:"export",disabled:0===e.state.multipleSelection.length,onClick:e.handleBatchUploadOrder},{default:k((()=>[S("批量上传订单("+y(e.state.multipleSelection.length)+")",1)])),_:1},8,["disabled","onClick"])])),_:1}),C(p,{loading:e.state.loading,setting:"",multiple:"",data:e.state.tableData,onClickSetting:e.handleClickSetting,onChangeMultiple:e.handleChangeMultiple},{"table-columns":k((()=>[(f(!0),b(O,null,R(e.headersShown,((a,r)=>(f(),b(s,{"show-overflow-tooltip":"",key:r,prop:a.prop,label:a.label,"min-width":e.calcHeaderWidth(a,r)},{header:k((e=>[C("span",null,y(e.column.label),1)])),default:k((e=>[C("span",null,y(e.row[a.prop]),1)])),_:2},1032,["prop","label","min-width"])))),128)),C(s,{label:"操作",fixed:"right"},{default:k((a=>[C(d,{type:"text",class:"modify",onClick:r=>e.handleUploadOrder(a.row)},{default:k((()=>[P])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["loading","data","onClickSetting","onChangeMultiple"]),C(c,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":a[2]||(a[2]=a=>e.state.pagination.currentPage=a),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":a[3]||(a[3]=a=>e.state.pagination.pageSize=a),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"]),C(m,{width:"516px",modelValue:e.state.uploadOrderDialog,"onUpdate:modelValue":a[6]||(a[6]=a=>e.state.uploadOrderDialog=a)},{title:k((()=>[I])),footer:k((()=>[C("div",M,[C(d,{onClick:a[5]||(a[5]=a=>e.state.uploadOrderDialog=!1),class:"cancel"},{default:k((()=>[U])),_:1}),C(d,{type:"primary",onClick:e.confirmUploadOrder,class:"confirm"},{default:k((()=>[w])),_:1},8,["onClick"])])])),default:k((()=>[C(g,{model:e.state.remarkForm,rules:e.remarkFormRules,ref:"remarkFormRef"},{default:k((()=>[C(u,{label:"订单备注","label-width":"90px",prop:"remark"},{default:k((()=>[C(n,{modelValue:e.state.remarkForm.remark,"onUpdate:modelValue":a[4]||(a[4]=a=>e.state.remarkForm.remark=a),type:"textarea",rows:4,placeholder:"请输入订单备注信息",autocomplete:"off",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])],64)}]]))}}}));
