var G=Object.defineProperty,q=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var w=(e,a,u)=>a in e?G(e,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[a]=u,b=(e,a)=>{for(var u in a||(a={}))H.call(a,u)&&w(e,u,a[u]);if(R)for(var u of R(a))Y.call(a,u)&&w(e,u,a[u]);return e},y=(e,a)=>q(e,z(a));import{d as $,a as L,i as T,r as W,c as B,I as P,S as X,w as V,o as j,E as i,m as F,q as O,y as n,G as s,N as C,C as p,z as N,F as k,A as J}from"../vendors/element-plus-6f9977bb.js";import{r as I,U as M,_ as Q,u as Z,b as x,d as ee}from"./index.1a2bb961.js";import{_ as ae}from"./tip-1b2ff95a.js";function te(e){return I.post(M.DELIVERY.queryMiddleTableDelivery,e)}function le(e){return I.post(M.DELIVERY.deleteDeliveryOrder,e)}const ne=$({name:"orderacceptance",setup(){const e=Z(),a=x(),u=ee(),f={scanCodeRef:L(null)},A=T("setTableHeaders"),m=()=>{l.loading=!0;const{pageSize:o,currentPage:c}=P(l.pagination),{dateRange:r,SOID:t,invoiceNumber:h,shortname:D,supplier:_}=P(l.searchParam),[K,U]=r||["",""];te({DeliverOrderId:t,SearchWord:D,RequestPurchaseBeginDate:K,RequestPurchaseEndDate:U,InvoiceNo:h,ProviderName:_,NeedCheckIsAccept:!0,IsAccept:!1,NeedCheckHChemical:!0,IsHChemical:!1,NeedPaging:!0,PageNumber:c,RecordPerPage:o}).then(v=>{l.pagination.total=v.TotalRecordCount,S(v.DeliverOrders)}).finally(()=>{l.loading=!1})},S=o=>{l.tableData=o.map(c=>{const{material:r,deliverOrder:t}=c;return y(b({},t),{shortname:r==null?void 0:r.short_name,standard:r==null?void 0:r.spec,brandName:l.brandIdMap[r==null?void 0:r.brand_id],department_name:t.DepartmentName,SODATE:t.SODATE.replace("T"," "),ENDDATE:t.ENDDATE.substr(0,10),material_name:r==null?void 0:r.name,store_pos:r==null?void 0:r.storePos})})},l=W({loading:!1,searchParam:{dateRange:"",SOID:"",invoiceNumber:"",shortname:"",supplier:""},pagination:{currentPage:1,total:0,pageSize:30},headersConfig:[{label:"\u5E8F\u53F7",prop:"id"},{label:"\u4EA4\u8D27\u5355ID",prop:"SOID"},{label:"\u4EA4\u8D27\u5355\u53F7",prop:"SONO"},{label:"\u7269\u6599\u540D\u79F0",prop:"material_name"},{label:"\u7269\u6599\u7B80\u79F0",prop:"shortname"},{label:"\u7269\u6599\u89C4\u683C",prop:"standard"},{label:"\u54C1\u724C",prop:"brandName"},{label:"\u90E8\u95E8\u540D\u79F0",prop:"department_name"},{label:"\u4EA4\u8D27\u65E5\u671F",prop:"SODATE"},{label:"\u91C7\u8D2D\u5355\u53F7",prop:"PONO"},{label:"\u91C7\u8D2D\u5355\u660E\u7EC6\u53F7",prop:"PODETNO"},{label:"\u9662\u5185\u7801",prop:"DITEMCODE"},{label:"\u9001\u8D27\u6570\u91CF",prop:"DQTY"},{label:"\u5355\u4F4D",prop:"DPACKUNIT"},{label:"\u542B\u7A0E\u5355\u4EF7",prop:"DTAXPRC"},{label:"\u542B\u7A0E\u91D1\u989D",prop:"TAXAMT"},{label:"\u6279\u53F7",prop:"LOTNO"},{label:"\u6548\u671F",prop:"ENDDATE",width:160},{label:"\u7A0E\u7387",prop:"TAXRATE"}],tableData:[],multipleSelection:[],brandIdMap:B(()=>u.getters.brandIdMap),batchDeleteDialog:!1,batchDeleteData:{SOGRPNO:""}}),d=o=>{o&&(l.pagination.currentPage=1),m()},E=B(()=>l.headersConfig.filter(o=>!o.hidden)),g={calcHeaderWidth:T("calcHeaderMinWidth"),handleClickSetting(){A(l.headersConfig,o=>{l.headersConfig=o})},handleChangeMultiple(o){l.multipleSelection=o},handlePaginationChange(){d(!1)},handleSearch(){d(!0)},handleScanKeyDownEnter(){d(!0)},handleGoToAccept(){const o=P(l.multipleSelection);e.push({name:"orderaccepting",params:{chosenTableData:JSON.stringify(o)}})},handleBatchDeleteDelivery(o){l.batchDeleteData.SOGRPNO=o.SOGRPNO,l.batchDeleteDialog=!0},confirmBatchDelete(){const o={SOGRPNO:l.batchDeleteData.SOGRPNO};le(o).then(()=>{X.success("\u64CD\u4F5C\u6210\u529F"),m(),l.batchDeleteDialog=!1})}};return V(()=>u.getters.settings,()=>{l.headersConfig=u.getters.settings[a.name]||l.headersConfig}),V(()=>l.batchDeleteDialog,o=>{o||(l.batchDeleteData={SOGRPNO:""})}),j(()=>{f.scanCodeRef.value.focus(),m()}),y(b(b({state:l},f),g),{headersShown:E})}}),oe={class:"date-box"},re=p("\u67E5\u8BE2"),ue=p("\u5220\u9664"),se=n("div",{class:"title"},"\u63D0\u793A",-1),de=n("div",{class:"tip-body"},[n("img",{src:ae,alt:""}),n("span",null,[p("\u786E\u8BA4\u8981"),n("span",{class:"highlight-text"},"\u5220\u9664"),p("\u6240\u9009\u62E9\u7684\u4EA4\u8D27\u5355\u5417?")])],-1),ie={class:"right-footer"},pe=p("\u53D6\u6D88"),ce=p("\u786E\u5B9A");function he(e,a,u,f,A,m){const S=i("el-date-picker"),l=i("el-input"),d=i("el-button"),E=i("styled-search"),g=i("el-table-column"),o=i("styled-table"),c=i("styled-pagination"),r=i("el-dialog");return F(),O(k,null,[n(E,{"hide-search-more":""},{"styled-search-left":s(()=>[n("div",oe,[n(S,{modelValue:e.state.searchParam.dateRange,"onUpdate:modelValue":a[1]||(a[1]=t=>e.state.searchParam.dateRange=t),type:"daterange","value-format":"YYYY-MM-DD","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue"])]),n(l,{ref:"scanCodeRef",modelValue:e.state.searchParam.SOID,"onUpdate:modelValue":a[2]||(a[2]=t=>e.state.searchParam.SOID=t),placeholder:"\u4EA4\u8D27\u5355\u53F7\u626B\u7801",clearable:"",onKeydown:C(e.handleScanKeyDownEnter,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),n(l,{modelValue:e.state.searchParam.invoiceNumber,"onUpdate:modelValue":a[3]||(a[3]=t=>e.state.searchParam.invoiceNumber=t),placeholder:"\u8BF7\u8F93\u5165\u53D1\u7968\u53F7",clearable:"",onKeydown:C(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),n(l,{modelValue:e.state.searchParam.shortname,"onUpdate:modelValue":a[4]||(a[4]=t=>e.state.searchParam.shortname=t),placeholder:"\u8BF7\u8F93\u5165\u7269\u6599\u540D\u79F0\u3001\u7B80\u79F0",clearable:"",onKeydown:C(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),n(l,{modelValue:e.state.searchParam.supplier,"onUpdate:modelValue":a[5]||(a[5]=t=>e.state.searchParam.supplier=t),placeholder:"\u8BF7\u8F93\u5165\u4F9B\u5E94\u5546\u540D\u79F0",clearable:"",onKeydown:C(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),n(d,{type:"primary",class:"search",onClick:e.handleSearch},{default:s(()=>[re]),_:1},8,["onClick"])]),"styled-search-right":s(()=>[n(d,{type:"primary",disabled:e.state.multipleSelection.length===0,class:"search",onClick:e.handleGoToAccept},{default:s(()=>[p("\u53BB\u9A8C\u6536("+N(e.state.multipleSelection.length)+")",1)]),_:1},8,["disabled","onClick"])]),_:1}),n(o,{loading:e.state.loading,multiple:"",setting:"",data:e.state.tableData,onChangeMultiple:e.handleChangeMultiple,onClickSetting:e.handleClickSetting},{"table-columns":s(()=>[(F(!0),O(k,null,J(e.headersShown,(t,h)=>(F(),O(g,{"show-overflow-tooltip":"",key:h,prop:t.prop,label:t.label,"min-width":e.calcHeaderWidth(t,h)},{header:s(D=>[n("span",null,N(D.column.label),1)]),default:s(D=>[n("span",null,N(D.row[t.prop]),1)]),_:2},1032,["prop","label","min-width"]))),128)),n(g,{label:"\u64CD\u4F5C",fixed:"right",width:"80"},{default:s(t=>[n(d,{type:"text",class:"delete",onClick:h=>e.handleBatchDeleteDelivery(t.row)},{default:s(()=>[ue]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["loading","data","onChangeMultiple","onClickSetting"]),n(c,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":a[6]||(a[6]=t=>e.state.pagination.currentPage=t),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":a[7]||(a[7]=t=>e.state.pagination.pageSize=t),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"]),n(r,{width:"466px",modelValue:e.state.batchDeleteDialog,"onUpdate:modelValue":a[9]||(a[9]=t=>e.state.batchDeleteDialog=t)},{title:s(()=>[se]),footer:s(()=>[n("div",ie,[n(d,{onClick:a[8]||(a[8]=t=>e.state.batchDeleteDialog=!1),class:"cancel"},{default:s(()=>[pe]),_:1}),n(d,{type:"primary",onClick:e.confirmBatchDelete,class:"confirm"},{default:s(()=>[ce]),_:1},8,["onClick"])])]),default:s(()=>[de]),_:1},8,["modelValue"])],64)}var fe=Q(ne,[["render",he]]);export{fe as default};
