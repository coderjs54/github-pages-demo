var v=Object.defineProperty,H=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var R=(e,r,u)=>r in e?v(e,r,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[r]=u,m=(e,r)=>{for(var u in r||(r={}))z.call(r,u)&&R(e,u,r[u]);if(E)for(var u of E(r))N.call(r,u)&&R(e,u,r[u]);return e},A=(e,r)=>H(e,T(r));import{r as I,U as V,_ as W,d as q,b as L}from"./index.1a2bb961.js";import{d as $,i as P,c as w,a as G,r as Q,I as B,S as J,w as M,o as Z,E as s,m as S,q as _,y as l,G as n,C as c,z as O,F as U,A as j}from"../vendors/element-plus-6f9977bb.js";function X(e){return I.post(V.ORDER.queryOrder,e)}function K(e){return I.post(V.ORDER.uploadOrder,e)}const Y=$({setup(){const e=q(),r=L(),u=P("setTableHeaders"),g=()=>{a.loading=!0;const{pageSize:t,currentPage:p}=B(a.pagination),{searchWord:i}=B(a.searchParam);X({search_word:i,IsHChemical:0,IsReceiveDeliverOrder:2,SendStatus:0,IsAccept:2,NeedPaging:!0,PageNum:p,RecordPerPage:t}).then(o=>{a.pagination.total=o.TotalRecordCount,y(o.AutoOrderInfo)}).finally(()=>{a.loading=!1})},y=t=>{a.tableData=t.map(p=>{const{material:i,autostore:f}=p;return A(m({},f),{brandName:a.brandIdMap[i.brand_id]})})},C=t=>{t&&(a.pagination.currentPage=1),g()},h=w(()=>a.headersConfig.filter(t=>!t.hidden)),d={remarkFormRef:G(null)},b={remarkFormRules:{remark:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BA2\u5355\u5907\u6CE8\u4FE1\u606F",trigger:"blur"}]}},a=Q({loading:!1,searchParam:{searchWord:"",dateRange:"",diseaseType:""},pagination:{currentPage:1,total:0,pageSize:30},headersConfig:[{label:"\u5E8F\u53F7",prop:"id"},{label:"\u8BA2\u5355\u7F16\u53F7",prop:"DJH"},{label:"\u5BA1\u6838\u65E5\u671F",prop:"SHRQ"},{label:"\u7269\u6599\u540D\u79F0",prop:"ZCMC"},{label:"\u89C4\u683C\u578B\u53F7",prop:"GGXH"},{label:"\u54C1\u724C",prop:"brandName"},{label:"\u5355\u4F4D",prop:"UNIT"},{label:"\u6570\u91CF",prop:"AMOUNT"},{label:"\u7533\u8BF7\u90E8\u95E8\u540D\u79F0",prop:"SQBMMC"},{label:"\u4F9B\u8D27\u5355\u4F4D\u540D\u79F0",prop:"GHDWMC"},{label:"\u8BB0\u5F55\u751F\u6210\u65E5\u671F",prop:"JLSCRQ"},{label:"\u5236\u5355\u4EBA\u540D\u79F0",prop:"ZDRMC"},{label:"\u5907\u6CE8",prop:"Remark"},{label:"\u4E70A\u6362B",prop:"buy_a_to_b",hidden:!e.getters.buyAToB}],tableData:[],multipleSelection:[],brandIdMap:w(()=>e.getters.brandIdMap),uploadOrderDialog:!1,remarkForm:{remark:""},orderIds:[]}),F={handleSearch(){C(!0)},calcHeaderWidth:P("calcHeaderMinWidth"),handleClickSetting(){u(a.headersConfig,t=>{a.headersConfig=t})},handleChangeMultiple(t){a.multipleSelection=t},handlePaginationChange(){C(!1)},handleUploadOrder(t){a.orderIds.push(t.id),a.uploadOrderDialog=!0},handleBatchUploadOrder(){a.orderIds=a.multipleSelection.map(t=>t.id),a.uploadOrderDialog=!0},confirmUploadOrder(){const{remark:t}=B(a.remarkForm),p={AutoOrderList:a.orderIds.map(i=>({AutoOrderId:i,Remark:t}))};K(p).then(i=>{J.success("\u64CD\u4F5C\u6210\u529F"),g(),a.uploadOrderDialog=!1})}};return M(()=>a.uploadOrderDialog,t=>{t||(a.remarkForm={remark:""},d.remarkFormRef.value.clearValidate())}),M(()=>e.getters.settings,()=>{a.headersConfig=e.getters.settings[r.name]||a.headersConfig}),Z(g),m(m(m({state:a,headersShown:h},F),b),d)}}),x=c("\u67E5\u8BE2"),ee=c("\u4E0A\u4F20\u8BA2\u5355"),ae=l("div",{class:"title"},"\u6DFB\u52A0\u5907\u6CE8",-1),re={class:"center-footer"},te=c("\u53D6\u6D88"),oe=c("\u786E\u8BA4");function le(e,r,u,g,y,C){const h=s("el-input"),d=s("el-button"),b=s("styled-search"),a=s("el-table-column"),F=s("styled-table"),t=s("styled-pagination"),p=s("el-form-item"),i=s("el-form"),f=s("el-dialog");return S(),_(U,null,[l(b,{"hide-search-more":""},{"styled-search-left":n(()=>[l(h,{modelValue:e.state.searchParam.searchWord,"onUpdate:modelValue":r[1]||(r[1]=o=>e.state.searchParam.searchWord=o),placeholder:"\u8BF7\u8F93\u5165\u67E5\u8BE2\u5173\u952E\u5B57",clearable:""},null,8,["modelValue"]),l(d,{type:"primary",class:"search",onClick:e.handleSearch},{default:n(()=>[x]),_:1},8,["onClick"])]),"styled-search-right":n(()=>[l(d,{type:"success",class:"export",disabled:e.state.multipleSelection.length===0,onClick:e.handleBatchUploadOrder},{default:n(()=>[c("\u6279\u91CF\u4E0A\u4F20\u8BA2\u5355("+O(e.state.multipleSelection.length)+")",1)]),_:1},8,["disabled","onClick"])]),_:1}),l(F,{loading:e.state.loading,setting:"",multiple:"",data:e.state.tableData,onClickSetting:e.handleClickSetting,onChangeMultiple:e.handleChangeMultiple},{"table-columns":n(()=>[(S(!0),_(U,null,j(e.headersShown,(o,k)=>(S(),_(a,{"show-overflow-tooltip":"",key:k,prop:o.prop,label:o.label,"min-width":e.calcHeaderWidth(o,k)},{header:n(D=>[l("span",null,O(D.column.label),1)]),default:n(D=>[l("span",null,O(D.row[o.prop]),1)]),_:2},1032,["prop","label","min-width"]))),128)),l(a,{label:"\u64CD\u4F5C",fixed:"right"},{default:n(o=>[l(d,{type:"text",class:"modify",onClick:k=>e.handleUploadOrder(o.row)},{default:n(()=>[ee]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["loading","data","onClickSetting","onChangeMultiple"]),l(t,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":r[2]||(r[2]=o=>e.state.pagination.currentPage=o),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":r[3]||(r[3]=o=>e.state.pagination.pageSize=o),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"]),l(f,{width:"516px",modelValue:e.state.uploadOrderDialog,"onUpdate:modelValue":r[6]||(r[6]=o=>e.state.uploadOrderDialog=o)},{title:n(()=>[ae]),footer:n(()=>[l("div",re,[l(d,{onClick:r[5]||(r[5]=o=>e.state.uploadOrderDialog=!1),class:"cancel"},{default:n(()=>[te]),_:1}),l(d,{type:"primary",onClick:e.confirmUploadOrder,class:"confirm"},{default:n(()=>[oe]),_:1},8,["onClick"])])]),default:n(()=>[l(i,{model:e.state.remarkForm,rules:e.remarkFormRules,ref:"remarkFormRef"},{default:n(()=>[l(p,{label:"\u8BA2\u5355\u5907\u6CE8","label-width":"90px",prop:"remark"},{default:n(()=>[l(h,{modelValue:e.state.remarkForm.remark,"onUpdate:modelValue":r[4]||(r[4]=o=>e.state.remarkForm.remark=o),type:"textarea",rows:4,placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u5907\u6CE8\u4FE1\u606F",autocomplete:"off",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}var de=W(Y,[["render",le]]);export{de as default};
