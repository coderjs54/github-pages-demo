var U=Object.defineProperty,z=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var B=(e,o,r)=>o in e?U(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,D=(e,o)=>{for(var r in o||(o={}))H.call(o,r)&&B(e,r,o[r]);if(w)for(var r of w(o))$.call(o,r)&&B(e,r,o[r]);return e},R=(e,o)=>z(e,Y(o));import{d as W,i as T,c as K,a as L,r as j,I as P,S as G,w as J,o as Q,E as s,m as y,q as b,y as n,G as l,N as X,F as M,A,z as O,C as S}from"../vendors/element-plus-6f9977bb.js";import{r as N,U as _,_ as Z,d as x,b as ee}from"./index.1a2bb961.js";function oe(){return N.post(_.INVOICE.queryInvoiceProvider,{})}function ae(e){return N.post(_.INVOICE.queryInvoice,e)}function te(e){return N.post(_.INVOICE.modifyInvoiceDate,e)}const ne=W({setup(){const e=x(),o=ee(),r=T("setTableHeaders"),C=()=>{t.loading=!0;const{pageSize:i,currentPage:u}=P(t.pagination),{dateRange:d,invoiceNumber:m,invoiceProvider:v}=P(t.searchParam),[g,f]=d||["",""];ae({BeginPostingDate:g,EndPostingDate:f,InvoiceNo:m,DeliverOrderId:"",HospitalCode:"",ProviderName:v,VerifyStatus:"1",ApproveStatus:"2",PageNo:u,RecordPerPage:i}).then(c=>{t.pagination.total=c.TotalRecordCount,k(c.invoices)}).finally(()=>{t.loading=!1})},k=i=>{t.tableData=i.map(u=>{const{INVOICEDATE:d,INVOICECODE:m,INVOICEAMT:v,INVOICENO:g,VerifyStatus:f,ApproveStatus:a,VerifyDate:c,SODATE:h,ProviderName:q}=u;return{invoiceNumber:g,invoiceSerialNumber:m,invoiceMoney:v,verifyStatus:f?"\u5DF2\u6838\u9500":"\u5F85\u6838\u9500",checkStatus:a?"\u5DF2\u5BA1\u6279":"\u5F85\u5BA1\u6279",receiveTime:d.substr(0,10),accountTime:c.substr(0,10),invoiceCreateTime:h.substr(0,10),provider:q}})},E=i=>{i&&(t.pagination.currentPage=1),C()},F=K(()=>t.headersConfig.filter(i=>!i.hidden)),I={modifyInvoiceFormRef:L(null)},V={labelWidth:"90px",modifyInvoiceFormRules:{date:[{required:!0,message:"\u8BF7\u9009\u62E9\u8D26\u52A1\u65E5\u671F",trigger:"change"}]}},t=j({loading:!1,searchParam:{dateRange:"",invoiceNumber:"",invoiceProvider:""},pagination:{currentPage:1,total:0,pageSize:30},invoiceProviderOptions:[],multipleSelection:[],headersConfig:[{label:"\u53D1\u7968\u53F7",prop:"invoiceNumber"},{label:"\u53D1\u7968\u7F16\u53F7",prop:"invoiceSerialNumber"},{label:"\u53D1\u7968\u91D1\u989D",prop:"invoiceMoney"},{label:"\u4F9B\u5E94\u5546",prop:"provider"},{label:"\u5F00\u7968\u65F6\u95F4",prop:"invoiceCreateTime"},{label:"\u6838\u9500\u72B6\u6001",prop:"verifyStatus"},{label:"\u5BA1\u6279\u72B6\u6001",prop:"checkStatus"},{label:"\u6570\u636E\u63A5\u6536\u65F6\u95F4",prop:"receiveTime"},{label:"\u8D26\u52A1\u65E5\u671F",prop:"accountTime"}],tableData:[],dialogModifyInvoice:!1,modifyInvoiceForm:{invoiceId:"",date:""}}),p={calcHeaderMinWidth:T("calcHeaderMinWidth"),handleClickSetting(){r(t.headersConfig,i=>{t.headersConfig=i})},handleChangeMultiple(i){t.multipleSelection=i},handlePaginationChange(){E(!1)},handleSearch(){E(!0)},handleModify(i){const{accountTime:u,invoiceNumber:d}=P(i);t.modifyInvoiceForm={invoiceId:d,date:u},t.dialogModifyInvoice=!0},confirmModifyInvoice(){I.modifyInvoiceFormRef.value.validate(i=>{if(!i)return;const{invoiceId:u,date:d}=P(t.modifyInvoiceForm);te({InvoiceNo:u,PostingDate:d}).then(()=>{G.success("\u64CD\u4F5C\u6210\u529F"),t.dialogModifyInvoice=!1}).finally(()=>{C()})})}};return J(()=>e.getters.settings,()=>{t.headersConfig=e.getters.settings[o.name]||t.headersConfig}),Q(()=>{Promise.all([oe().then(i=>{t.invoiceProviderOptions=i.Providers.map(u=>({label:u,value:u}))})]).then(()=>{C()})}),R(D(D(D({state:t},I),V),p),{headersShown:F})}}),ie={class:"date-box"},le=S("\u67E5\u8BE2"),re=S("\u4FEE\u6539"),ue=n("div",{class:"title"},"\u7F16\u8F91",-1),se={class:"center-footer"},de=S("\u53D6\u6D88"),ce=S("\u786E\u8BA4");function pe(e,o,r,C,k,E){const F=s("el-date-picker"),I=s("el-input"),V=s("el-option"),t=s("el-select"),p=s("el-button"),i=s("styled-search"),u=s("el-table-column"),d=s("styled-table"),m=s("styled-pagination"),v=s("el-form-item"),g=s("el-form"),f=s("el-dialog");return y(),b(M,null,[n(i,{"hide-search-more":""},{"styled-search-left":l(()=>[n("div",ie,[n(F,{modelValue:e.state.searchParam.dateRange,"onUpdate:modelValue":o[1]||(o[1]=a=>e.state.searchParam.dateRange=a),type:"daterange","value-format":"YYYY-MM-DD","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue"])]),n(I,{modelValue:e.state.searchParam.invoiceNumber,"onUpdate:modelValue":o[2]||(o[2]=a=>e.state.searchParam.invoiceNumber=a),placeholder:"\u8BF7\u8F93\u5165\u53D1\u7968\u53F7",clearable:"",onKeydown:X(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),n(t,{modelValue:e.state.searchParam.invoiceProvider,"onUpdate:modelValue":o[3]||(o[3]=a=>e.state.searchParam.invoiceProvider=a),placeholder:"\u8BF7\u9009\u62E9\u4F9B\u5E94\u5546",clearable:"",onChange:e.handleSearch},{default:l(()=>[(y(!0),b(M,null,A(e.state.invoiceProviderOptions,(a,c)=>(y(),b(V,{key:c,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),n(p,{type:"primary",class:"search",onClick:e.handleSearch},{default:l(()=>[le]),_:1},8,["onClick"])]),_:1}),n(d,{loading:e.state.loading,setting:"",multiple:"",data:e.state.tableData,onChangeMultiple:e.handleChangeMultiple,onClickSetting:e.handleClickSetting},{"table-columns":l(()=>[(y(!0),b(M,null,A(e.headersShown,(a,c)=>(y(),b(u,{"show-overflow-tooltip":"",key:c,prop:a.prop,label:a.label,"min-width":e.calcHeaderMinWidth(a)},{header:l(h=>[n("span",null,O(h.column.label),1)]),default:l(h=>[n("span",null,O(h.row[a.prop]),1)]),_:2},1032,["prop","label","min-width"]))),128)),n(u,{label:"\u64CD\u4F5C","min-width":100,fixed:"right"},{default:l(a=>[n(p,{class:"modify",type:"text",onClick:c=>e.handleModify(a.row)},{default:l(()=>[re]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["loading","data","onChangeMultiple","onClickSetting"]),n(m,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":o[4]||(o[4]=a=>e.state.pagination.currentPage=a),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":o[5]||(o[5]=a=>e.state.pagination.pageSize=a),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"]),n(f,{width:"516px",modelValue:e.state.dialogModifyInvoice,"onUpdate:modelValue":o[8]||(o[8]=a=>e.state.dialogModifyInvoice=a)},{title:l(()=>[ue]),footer:l(()=>[n("div",se,[n(p,{onClick:o[7]||(o[7]=a=>e.state.modifyDialog=!1),class:"cancel"},{default:l(()=>[de]),_:1}),n(p,{type:"primary",onClick:e.confirmModifyInvoice,class:"confirm"},{default:l(()=>[ce]),_:1},8,["onClick"])])]),default:l(()=>[n(g,{ref:"modifyInvoiceFormRef",model:e.state.modifyInvoiceForm,rules:e.modifyInvoiceFormRules},{default:l(()=>[n(v,{label:"\u8D26\u52A1\u65E5\u671F","label-width":e.labelWidth,prop:"date"},{default:l(()=>[n(F,{modelValue:e.state.modifyInvoiceForm.date,"onUpdate:modelValue":o[6]||(o[6]=a=>e.state.modifyInvoiceForm.date=a),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u65E5\u671F"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}var fe=Z(ne,[["render",pe]]);export{fe as default};
