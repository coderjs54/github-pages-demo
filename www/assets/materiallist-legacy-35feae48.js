System.register(["../vendors/element-plus-legacy-e48d1ae3.js","./index-legacy.acc39ef9.js","./instrument-legacy-58deeedd.js","./department-legacy-7e39a566.js","./tip-legacy-d18ff986.js"],(function(e){"use strict";var a,t,n,l,i,r,o,s,p,d,c,g,u,m,h,y,_,b,f,D,M,C,S,P,T,w,k,x;return{setters:[function(e){a=e.d,t=e.i,n=e.r,l=e.c,i=e.S,r=e.w,o=e.o,s=e.E,p=e.m,d=e.q,c=e.y,g=e.G,u=e.N,m=e.F,h=e.A,y=e.z,_=e.C,b=e.I},function(e){f=e.r,D=e.U,M=e._,C=e.u,S=e.d,P=e.b,T=e.S},function(e){w=e.i},function(e){k=e.d},function(e){x=e._}],execute:function(){function U(e=""){return f.post(D.VENDOR.queryVendor,{search_word:e})}const v=a({setup(){const e=C(),a=S(),s=P(),p=t("exportXLSX"),d=t("setTableHeaders"),c=()=>{m.loading=!0;const{pageSize:e,currentPage:a}=b(m.pagination),{shortname:t,isDanger:n}=b(m.searchParam);(function(e){return f.post(D.MATERIAL.queryMaterial,e)})({searchWord:t,DepartmentId:"",MaterialType:"",BrandId:"",InstrumentId:"",NeedPaging:!0,PageNo:a,RecordPerPage:e,CheckHChemical:!0,IsHChemical:n}).then((e=>{m.pagination.total=e.TotalRecordCount,g(e.materials)})).finally((()=>{m.loading=!1}))},g=e=>{m.tableData=e.map((e=>{const{LowerLimitAlert:a,UpperLimitAlert:t,brand_id:n,departmentOwners:l,hospital_code:i,id:r,inOutStoreUnits:o,instrumentOwners:s,invoiceCorp:p,isGift:d,IsHazardousChemical:c,isMinUnitPurchase:g,isPublicReagent:u,lowestStoreAlert:h,material_type:y,minimumUnit:_,name:b,nearExpireAlertDay:f,needPurchase:D,onBoardInfo:M,onBoardType:C,openValidDays:S,performanceTest:P,printOpenLabel:T,producer:x,purchasePrice:U,purchaseUnit:v,shippingCorp:I,short_name:V,spec:z,stopUseReason:E,storeCondition:A,storePos:O,supplier:R,system_code:j,tempratureScope:q,uniqueCodeManage:H,unitMultiples:L,DiseaseType:N}=e,W=k(l).map((e=>m.departmentMaps[e])).join(","),B=w(s).map((e=>m.instrumentMaps[e])).join(",");return{id:r,hospital_code:i,system_code:j,material_name:b,brand:m.brandMaps[n]||"未知品牌",is_danger:c?"是":"否",type:m.MaterialTypeMap.get(y),size:z,disease:N||"无",restore_condition:m.StoreTypeMap.get(A),temperature:q,arrived_scope:m.OnboardTypeMap.get(C),arrived_date:M,purchase_price:U,print_label:T?"是":"否",department:W,instrument:B,open_expire:`${S} 天`,purchase_unit:m.MinUnitTypeMap.get(v),min_unit:m.MinUnitTypeMap.get(_),unique_code:H?"是":"否",is_gift:d?"是":"否",store_position:O,purchase_status:D?"采购":"停购",stop_reason:E,public:u?"是":"否",min_unit_purchase:g?"是":"否",supplier:m.companyMaps[R],invoice_company:m.companyMaps[p],ship_company:m.companyMaps[I]}}))},u=e=>{e&&(m.pagination.currentPage=1),c()},m=n({loading:!1,searchParam:{shortname:"",isDanger:!1},pagination:{currentPage:1,total:0,pageSize:30},MaterialTypeMap:l((()=>a.getters.MaterialTypeMap)),StoreTypeMap:l((()=>a.getters.StoreTypeMap)),MinUnitTypeMap:l((()=>a.getters.MinUnitTypeMap)),OnboardTypeMap:l((()=>a.getters.OnboardTypeMap)),tableData:[],headersConfig:[{label:"序号",prop:"id"},{label:"院内码",prop:"hospital_code"},{label:"物料名称",prop:"material_name"},{label:"是否危险品",prop:"is_danger"},{label:"品牌",prop:"brand"},{label:"系统码",prop:"system_code"},{label:"类型",prop:"type"},{label:"规格",prop:"size"},{label:"病种信息",prop:"disease"},{label:"储存条件",prop:"restore_condition"},{label:"温度范围",prop:"temperature"},{label:"到货范围",prop:"arrived_scope"},{label:"到货日期",prop:"arrived_date"},{label:"采购单价",prop:"purchase_price"},{label:"打印开瓶标贴",prop:"print_label"},{label:"所属部门",prop:"department"},{label:"所属仪器",prop:"instrument"},{label:"开封效期",prop:"open_expire"},{label:"库存位置",prop:"store_position"},{label:"采购单位",prop:"purchase_unit"},{label:"最小单位",prop:"min_unit"},{label:"唯一管理码",prop:"unique_code"},{label:"是否赠品",prop:"is_gift"},{label:"采购状态",prop:"purchase_status"},{label:"公共试剂",prop:"public"},{label:"最小单位采购",prop:"min_unit_purchase"},{label:"供应商",prop:"supplier"},{label:"开票公司",prop:"invoice_company"},{label:"发货公司",prop:"ship_company"}],brandMaps:l((()=>a.getters.brandIdMap)),instrumentMaps:l((()=>a.getters.instrumentIdMap)),companyMaps:{},departmentMaps:{},singleDelDialog:!1,singleDelDialogData:{id:"",name:""},departmentTreeData:[]}),h=l((()=>m.headersConfig.filter((e=>!e.hidden)))),y={calcHeaderMinWidth:t("calcHeaderMinWidth"),handleClickSetting(){d(m.headersConfig,(e=>{m.headersConfig=e}))},handlePaginationChange(){u(!1)},handleSearch(){u(!0)},handleModify(a){e.push(`/materialmodify?name=${a.material_name}`)},handleSingleDelete(e){m.singleDelDialogData={id:e.id,name:e.material_name},m.singleDelDialog=!0},confirmSingleDelete(){(function(e){return f.post(D.MATERIAL.deleteMaterial,{id:e})})(m.singleDelDialogData.id).then((()=>{i.success("操作成功"),c()})).finally((()=>{m.singleDelDialog=!1}))},handleExport(){p(m.headersConfig,m.tableData,"物料列表","物料列表详情")}};return r((()=>a.getters.settings),(()=>{m.headersConfig=a.getters.settings[s.name]||m.headersConfig})),r((()=>m.singleDelDialog),(e=>{e||(m.singleDelDialogData={id:"",name:""})})),o((()=>{Promise.all([U().then((e=>{e.companies.forEach((e=>{m.companyMaps[e.id]=e.name}))})),f.get(D.DEPARTMENT.queryDepartment).then((e=>{e.departments.forEach((e=>{m.departmentMaps[e.id]=e.name})),m.departmentTreeData=T(e.departments)}))]).then((()=>{c()}))})),{state:m,...y,headersShown:h}}}),I=_("查询"),V=_("导出xlsx "),z={key:1},E=_("编辑"),A=_("删除"),O=c("div",{class:"title"},"提示",-1),R={class:"tip-body"},j=c("img",{src:x,alt:""},null,-1),q=_("确认要将名为"),H={class:"item-name"},L=_("的物料"),N=c("span",{class:"highlight-text"},"删除",-1),W=_("吗?"),B={class:"right-footer"},G=_("取消"),K=_("确定");e("default",M(v,[["render",function(e,a,t,n,l,i){const r=s("el-input"),o=s("el-button"),b=s("el-switch"),f=s("styled-search"),D=s("el-tag"),M=s("el-table-column"),C=s("styled-table"),S=s("styled-pagination"),P=s("el-dialog");return p(),d(m,null,[c(f,{"hide-search-more":""},{"styled-search-left":g((()=>[c(r,{modelValue:e.state.searchParam.shortname,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.searchParam.shortname=a),placeholder:"请输入物料名称、简称、或院内码",clearable:"",onKeydown:u(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),c(o,{type:"primary",class:"search",onClick:e.handleSearch},{default:g((()=>[I])),_:1},8,["onClick"]),c(b,{modelValue:e.state.searchParam.isDanger,"onUpdate:modelValue":a[2]||(a[2]=a=>e.state.searchParam.isDanger=a),"active-text":"危险品","inactive-text":"非危险品",onChange:e.handleSearch},null,8,["modelValue","onChange"])])),"styled-search-right":g((()=>[c(o,{type:"success",class:"export",disabled:0===e.state.tableData.length,onClick:e.handleExport},{default:g((()=>[V])),_:1},8,["disabled","onClick"])])),_:1}),c(C,{loading:e.state.loading,setting:"",data:e.state.tableData,onClickSetting:e.handleClickSetting},{"table-columns":g((()=>[(p(!0),d(m,null,h(e.headersShown,((a,t)=>(p(),d(M,{"show-overflow-tooltip":"",key:t,prop:a.prop,label:a.label,"min-width":e.calcHeaderMinWidth(a,t)},{header:g((e=>[c("span",null,y(e.column.label),1)])),default:g((e=>["is_danger"===a.prop?(p(),d(D,{key:0,class:"是"===e.row.is_danger?"danger-material":"normal-material"},{default:g((()=>[_(y(e.row.is_danger),1)])),_:2},1032,["class"])):(p(),d("span",z,y(e.row[a.prop]),1))])),_:2},1032,["prop","label","min-width"])))),128)),c(M,{label:"操作",fixed:"right",width:"110"},{default:g((a=>[c(o,{type:"text",class:"modify",onClick:t=>e.handleModify(a.row)},{default:g((()=>[E])),_:2},1032,["onClick"]),c(o,{type:"text",class:"delete",onClick:t=>e.handleSingleDelete(a.row)},{default:g((()=>[A])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["loading","data","onClickSetting"]),c(S,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":a[3]||(a[3]=a=>e.state.pagination.currentPage=a),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":a[4]||(a[4]=a=>e.state.pagination.pageSize=a),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"]),c(P,{width:"466px",modelValue:e.state.singleDelDialog,"onUpdate:modelValue":a[6]||(a[6]=a=>e.state.singleDelDialog=a)},{title:g((()=>[O])),footer:g((()=>[c("div",B,[c(o,{onClick:a[5]||(a[5]=a=>e.state.singleDelDialog=!1),class:"cancel"},{default:g((()=>[G])),_:1}),c(o,{type:"primary",onClick:e.confirmSingleDelete,class:"confirm"},{default:g((()=>[K])),_:1},8,["onClick"])])])),default:g((()=>[c("div",R,[j,c("span",null,[q,c("span",H,y(e.state.singleDelDialogData.name),1),L,N,W])])])),_:1},8,["modelValue"])],64)}]]))}}}));
