var W=Object.defineProperty;var M=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var V=(e,o,t)=>o in e?W(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,f=(e,o)=>{for(var t in o||(o={}))L.call(o,t)&&V(e,t,o[t]);if(M)for(var t of M(o))Y.call(o,t)&&V(e,t,o[t]);return e};import{r as O,U as N,_ as X,d as H}from"./index.1a2bb961.js";import{d as $,a as K,r as Q,c as w,i as j,I as S,S as z,o as G,w as J,E as s,m as _,q as I,y as l,G as u,F as g,A as R,z as B,C as T}from"../vendors/element-plus-6f9977bb.js";function Z(e){return O.post(N.DELIVERY.queryMiddleTableDelivery,e)}function x(e=""){return O.post(N.VENDOR.queryVendor,{search_word:e})}function ee(e){return O.post(N.INVOICE.manualAddInvoice,e)}const oe=$({setup(){const e=H(),o=()=>{n.loading=!0,Z({DeliverOrderId:"",SearchWord:"",RequestPurchaseBeginDate:"",RequestPurchaseEndDate:"",InvoiceNo:"",ProviderName:"",NeedCheckIsAccept:!0,IsAccept:!0,NeedCheckHChemical:!1,IsHChemical:!1,NeedPaging:!1,PageNumber:"",RecordPerPage:""}).then(p=>{n.tableData=p.DeliverOrders.map(c=>{const{material:d,deliverOrder:r}=c,{DITEMCODE:m,SONO:b,DQTY:h,DTAXPRC:C,TAXAMT:F,SODATE:y,ENDDATE:a,LOTNO:D,DepartmentName:v}=r;return{server:r,invoice_serial_number:"",verify_detail_number:b,material_name:d==null?void 0:d.name,purchase_price:C,delivery_count:h,purchase_money:F,delivery_date:y,delivery_number:"090878899",purchase_name:v,invoice_company_name:"",delivery_company_name:"",batch_number:D,expire_at:a}})}).finally(()=>{n.loading=!1})},t={labelWidth:"90px",addInvoiceFormRules:{invoiceNumber:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D1\u7968\u53F7\u7801",trigger:"blur"}],invoiceCode:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D1\u7968\u4EE3\u7801",trigger:"blur"}],invoiceDate:[{required:!0,message:"\u8BF7\u9009\u62E9\u8D26\u52A1\u65E5\u671F",trigger:"change"}],invoiceCompany:[{required:!0,message:"\u8BF7\u9009\u62E9\u5F00\u7968\u516C\u53F8",trigger:"change"}],invoiceMoney:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D1\u7968\u91D1\u989D",trigger:"blur"}]}},E={addInvoiceFormRef:K(null)},n=Q({loading:!1,CompanyTypeMap:w(()=>e.getters.CompanyTypeMap),headersConfig:[{label:"\u53D1\u7968\u5355\u53F7",prop:"invoice_serial_number"},{label:"\u4EA4\u8D27\u5355\u53F7",prop:"verify_detail_number"},{label:"\u7269\u6599\u540D\u79F0",prop:"material_name"},{label:"\u91C7\u8D2D\u5355\u4EF7",prop:"purchase_price"},{label:"\u4EA4\u8D27\u91CF",prop:"delivery_count"},{label:"\u91C7\u8D2D\u91D1\u989D",prop:"purchase_money"},{label:"\u4EA4\u8D27\u65E5\u671F",prop:"delivery_date"},{label:"\u53D1\u8D27\u5355\u53F7",prop:"delivery_number"},{label:"\u8BF7\u8D2D\u5355\u4F4D",prop:"purchase_name"},{label:"\u5F00\u7968\u516C\u53F8\u540D\u79F0",prop:"invoice_company_name"},{label:"\u53D1\u8D27\u516C\u53F8\u540D\u79F0",prop:"delivery_company_name"},{label:"\u6279\u6B21\u53F7",prop:"batch_number"},{label:"\u6548\u671F",prop:"expire_at",width:100}],tableData:[],multipleSelection:[],hospitalCodeMap:w(()=>e.getters.hospitalCodeMap),invoiceCompanyOptions:[],dialogShow:!1,addInvoiceForm:{invoiceNumber:"",invoiceCode:"",invoiceDate:"",invoiceCompany:"",invoiceMoney:""}}),A={calcHeaderWidth:j("calcHeaderMinWidth"),handleChangeMultiple(i){n.multipleSelection=i},handleAddInvoice(){n.dialogShow=!0},handleConfirmAddInvoice(){E.addInvoiceFormRef.value.validate(i=>{if(!i)return;const{invoiceNumber:p,invoiceCode:c,invoiceDate:d,invoiceCompany:r,invoiceMoney:m}=S(n.addInvoiceForm),{SOID:b,SONO:h,SODATE:C,PONO:F,PODETNO:y,DITEMCODE:a,DPACKUNIT:D,DQTY:v,DTAXPRC:P,TAXAMT:k,LOTNO:q,ENDDATE:U}=S(n.multipleSelection[0].server);ee({INVDETID:p,SOID:b,SONO:h,SODATE:C,PONO:F,PODETNO:y,DITEMCODE:a,DPACKUNIT:D,DQTY:v,DTAXPRC:P,TAXAMT:k,LOTNO:q,ENDDATE:U,INVOICETITLE:r,INVOICECODE:c,INVOICENO:p,INVOICEDATE:d,INVOICEAMT:m,INVOICEMARK:"test remarks"}).then(de=>{z.success("\u64CD\u4F5C\u6210\u529F"),o(),n.dialogShow=!1})})}};return G(()=>{Promise.all([x().then(i=>{const p=i.companies,c=[];for(let d=0;d<p.length;d++){const r=p[d];switch(n.CompanyTypeMap.get(r.type)){case"\u4F9B\u5E94\u5546":break;case"\u53D1\u7968\u516C\u53F8":c.push({label:r.name,id:r.name});break}}n.invoiceCompanyOptions=c})]).then(()=>{o()})}),J(()=>n.dialogShow,i=>{i||(n.addInvoiceForm={invoiceNumber:"",invoiceCode:"",invoiceDate:"",invoiceCompany:"",invoiceMoney:""})}),f(f(f({state:n},A),t),E)}}),ae=T("\u5F00\u53D1\u7968"),le=l("div",{class:"title"},"\u7F16\u8F91",-1),ue={class:"center-footer"},ne=T("\u53D6\u6D88"),te=T("\u786E\u8BA4");function ie(e,o,t,E,n,A){const i=s("el-button"),p=s("styled-search"),c=s("el-table-column"),d=s("styled-table"),r=s("el-input"),m=s("el-form-item"),b=s("el-date-picker"),h=s("el-option"),C=s("el-select"),F=s("el-form"),y=s("el-dialog");return _(),I(g,null,[l(p,{"hide-search-more":""},{"styled-search-right":u(()=>[l(i,{type:"success",class:"export",onClick:e.handleAddInvoice,disabled:e.state.multipleSelection.length!==1},{default:u(()=>[ae]),_:1},8,["onClick","disabled"])]),_:1}),l(d,{loading:e.state.loading,multiple:"",data:e.state.tableData,onChangeMultiple:e.handleChangeMultiple},{"table-columns":u(()=>[(_(!0),I(g,null,R(e.state.headersConfig,(a,D)=>(_(),I(c,{"show-overflow-tooltip":"",key:D,prop:a.prop,label:a.label,"min-width":e.calcHeaderWidth(a,D)},{header:u(v=>[l("span",null,B(v.column.label),1)]),default:u(v=>[l("span",null,B(v.row[a.prop]),1)]),_:2},1032,["prop","label","min-width"]))),128))]),_:1},8,["loading","data","onChangeMultiple"]),l(y,{width:"516px",modelValue:e.state.dialogShow,"onUpdate:modelValue":o[7]||(o[7]=a=>e.state.dialogShow=a)},{title:u(()=>[le]),footer:u(()=>[l("div",ue,[l(i,{class:"cancel",onClick:o[6]||(o[6]=a=>e.state.dialogShow=!1)},{default:u(()=>[ne]),_:1}),l(i,{type:"primary",class:"confirm",onClick:e.handleConfirmAddInvoice},{default:u(()=>[te]),_:1},8,["onClick"])])]),default:u(()=>[l(F,{ref:"addInvoiceFormRef",model:e.state.addInvoiceForm,rules:e.addInvoiceFormRules},{default:u(()=>[l(m,{label:"\u53D1\u7968\u53F7\u7801","label-width":e.labelWidth,prop:"invoiceNumber"},{default:u(()=>[l(r,{modelValue:e.state.addInvoiceForm.invoiceNumber,"onUpdate:modelValue":o[1]||(o[1]=a=>e.state.addInvoiceForm.invoiceNumber=a),type:"text",placeholder:"\u8BF7\u8F93\u5165\u53D1\u7968\u53F7\u7801"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(m,{label:"\u53D1\u7968\u4EE3\u7801","label-width":e.labelWidth,prop:"invoiceCode"},{default:u(()=>[l(r,{modelValue:e.state.addInvoiceForm.invoiceCode,"onUpdate:modelValue":o[2]||(o[2]=a=>e.state.addInvoiceForm.invoiceCode=a),type:"text",placeholder:"\u8BF7\u8F93\u5165\u53D1\u7968\u4EE3\u7801"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(m,{label:"\u53D1\u7968\u65E5\u671F","label-width":e.labelWidth,prop:"invoiceDate"},{default:u(()=>[l(b,{modelValue:e.state.addInvoiceForm.invoiceDate,"onUpdate:modelValue":o[3]||(o[3]=a=>e.state.addInvoiceForm.invoiceDate=a),type:"date","value-format":"YYYY-MM-DD",placeholder:"\u8BF7\u9009\u62E9\u65E5\u671F"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(m,{label:"\u53D1\u7968\u62AC\u5934","label-width":e.labelWidth,prop:"invoiceCompany"},{default:u(()=>[l(C,{modelValue:e.state.addInvoiceForm.invoiceCompany,"onUpdate:modelValue":o[4]||(o[4]=a=>e.state.addInvoiceForm.invoiceCompany=a),placeholder:"\u8BF7\u9009\u62E9\u5F00\u7968\u516C\u53F8"},{default:u(()=>[(_(!0),I(g,null,R(e.state.invoiceCompanyOptions,a=>(_(),I(h,{label:a.name,value:a.id,key:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(m,{label:"\u53D1\u7968\u91D1\u989D","label-width":e.labelWidth,prop:"invoiceMoney"},{default:u(()=>[l(r,{modelValue:e.state.addInvoiceForm.invoiceMoney,"onUpdate:modelValue":o[5]||(o[5]=a=>e.state.addInvoiceForm.invoiceMoney=a),type:"text",placeholder:"\u8BF7\u8F93\u5165\u53D1\u7968\u91D1\u989D"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}var me=X(oe,[["render",ie]]);export{me as default};
