var b=Object.defineProperty;var g=(r,s,t)=>s in r?b(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t;var _=(r,s,t)=>(g(r,typeof s!="symbol"?s+"":s,t),t);const m=window.XLSX;class k{constructor(){_(this,"xlsx");this.xlsx=m}handleColumns(s){return s.reduce((t,e)=>{const{label:l,prop:o}=e;return t.labels.push(l),t.props.push(o),t},{labels:[],props:[]})}handleTableData(s,t,e){return[t].concat(e.map(l=>s.map(o=>l[o])))}handleTableDataset(s,t){return t.reduce((e,l)=>{const{group:o,data:n}=l;return e.dataset.push(n.map(h=>s.map(a=>h[a]))),e.groups.push(o),e},{groups:[],dataset:[]})}calcSheetHeaderMinWidth(s,t){t["!cols"]=s.map(e=>({wch:Math.max(e==null?void 0:e.length,5)*2}))}exportSingleSheet(s,t,e,l){const{labels:o,props:n}=this.handleColumns(s),h=this.handleTableData(n,o,t),a=this.xlsx.utils.book_new(),i=this.xlsx.utils.aoa_to_sheet(h);this.calcSheetHeaderMinWidth(o,i),this.xlsx.utils.book_append_sheet(a,i,e),this.xlsx.writeFile(a,`${l}.xlsx`)}exportAlertSingleSheet(s,t,e){const{labels:l,props:o}=this.handleColumns(s),{groups:n,dataset:h}=this.handleTableDataset(o,t),a=[];for(let u=0;u<n.length;u++){const p=n[u];a.push([p]),a.push(l);for(let c=0;c<h[u].length;c++){const d=h[u][c];a.push(d)}a.push([])}const i=this.xlsx.utils.book_new(),x=this.xlsx.utils.aoa_to_sheet(a);this.calcSheetHeaderMinWidth(l,x),this.xlsx.utils.book_append_sheet(i,x,"\u62A5\u8B66\u4FE1\u606F"),this.xlsx.writeFile(i,`${e}.xlsx`)}exportGiftSingleSheet(s,t){const{labels:e,props:l}=this.handleColumns(s),o=this.handleTableData(l,e,t);for(let x=0;x<5;x++)o.push([]);o.push(["\u4F9B\u5E94\u5546\u7B7E\u5B57:____________    \u79D1\u5BA4\u7B7E\u5B57:____________"]);const n=this.xlsx.utils.book_new(),h=this.xlsx.utils.aoa_to_sheet(o),a=o.length,i=e.length;h["!merges"]=[{s:{c:0,r:a},e:{c:i-1,r:a-1}}],this.calcSheetHeaderMinWidth(e,h),this.xlsx.utils.book_append_sheet(n,h,"\u62A5\u8B66\u4FE1\u606F"),this.xlsx.writeFile(n,"\u8D60\u54C1\u62A5\u8B66.xlsx")}exportInventoryCheckRecordsDetail(s,t){const e=this.xlsx.utils.book_new();for(let l=0;l<s.length;l++){const{columns:o,tableData:n,sheetname:h}=s[l],{labels:a,props:i}=this.handleColumns(o),x=this.handleTableData(i,a,n),u=this.xlsx.utils.aoa_to_sheet(x);this.calcSheetHeaderMinWidth(a,u),this.xlsx.utils.book_append_sheet(e,u,h)}this.xlsx.writeFile(e,`${t}.xlsx`)}}var S=new k;export{S as _};
