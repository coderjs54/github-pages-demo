System.register(["./index-legacy.acc39ef9.js","../vendors/element-plus-legacy-e48d1ae3.js"],(function(e){"use strict";var l,a,o,i,n,t,d,r,c,p,u,m,s,v,h,b,y,C,I,g,D,_;return{setters:[function(e){l=e.r,a=e.U,o=e._,i=e.d},function(e){n=e.d,t=e.a,d=e.r,r=e.c,c=e.i,p=e.I,u=e.S,m=e.o,s=e.w,v=e.E,h=e.m,b=e.q,y=e.y,C=e.G,I=e.F,g=e.A,D=e.z,_=e.C}],execute:function(){function O(e=""){return l.post(a.VENDOR.queryVendor,{search_word:e})}const f=n({setup(){const e=i(),o=()=>{v.loading=!0,function(e){return l.post(a.DELIVERY.queryMiddleTableDelivery,e)}({DeliverOrderId:"",SearchWord:"",RequestPurchaseBeginDate:"",RequestPurchaseEndDate:"",InvoiceNo:"",ProviderName:"",NeedCheckIsAccept:!0,IsAccept:!0,NeedCheckHChemical:!1,IsHChemical:!1,NeedPaging:!1,PageNumber:"",RecordPerPage:""}).then((e=>{v.tableData=e.DeliverOrders.map((e=>{const{material:l,deliverOrder:a}=e,{DITEMCODE:o,SONO:i,DQTY:n,DTAXPRC:t,TAXAMT:d,SODATE:r,ENDDATE:c,LOTNO:p,DepartmentName:u}=a;return{server:a,invoice_serial_number:"",verify_detail_number:i,material_name:null==l?void 0:l.name,purchase_price:t,delivery_count:n,purchase_money:d,delivery_date:r,delivery_number:"090878899",purchase_name:u,invoice_company_name:"",delivery_company_name:"",batch_number:p,expire_at:c}}))})).finally((()=>{v.loading=!1}))},n={addInvoiceFormRef:t(null)},v=d({loading:!1,CompanyTypeMap:r((()=>e.getters.CompanyTypeMap)),headersConfig:[{label:"发票单号",prop:"invoice_serial_number"},{label:"交货单号",prop:"verify_detail_number"},{label:"物料名称",prop:"material_name"},{label:"采购单价",prop:"purchase_price"},{label:"交货量",prop:"delivery_count"},{label:"采购金额",prop:"purchase_money"},{label:"交货日期",prop:"delivery_date"},{label:"发货单号",prop:"delivery_number"},{label:"请购单位",prop:"purchase_name"},{label:"开票公司名称",prop:"invoice_company_name"},{label:"发货公司名称",prop:"delivery_company_name"},{label:"批次号",prop:"batch_number"},{label:"效期",prop:"expire_at",width:100}],tableData:[],multipleSelection:[],hospitalCodeMap:r((()=>e.getters.hospitalCodeMap)),invoiceCompanyOptions:[],dialogShow:!1,addInvoiceForm:{invoiceNumber:"",invoiceCode:"",invoiceDate:"",invoiceCompany:"",invoiceMoney:""}}),h={calcHeaderWidth:c("calcHeaderMinWidth"),handleChangeMultiple(e){v.multipleSelection=e},handleAddInvoice(){v.dialogShow=!0},handleConfirmAddInvoice(){n.addInvoiceFormRef.value.validate((e=>{if(!e)return;const{invoiceNumber:i,invoiceCode:n,invoiceDate:t,invoiceCompany:d,invoiceMoney:r}=p(v.addInvoiceForm),{SOID:c,SONO:m,SODATE:s,PONO:h,PODETNO:b,DITEMCODE:y,DPACKUNIT:C,DQTY:I,DTAXPRC:g,TAXAMT:D,LOTNO:_,ENDDATE:O}=p(v.multipleSelection[0].server);(function(e){return l.post(a.INVOICE.manualAddInvoice,e)})({INVDETID:i,SOID:c,SONO:m,SODATE:s,PONO:h,PODETNO:b,DITEMCODE:y,DPACKUNIT:C,DQTY:I,DTAXPRC:g,TAXAMT:D,LOTNO:_,ENDDATE:O,INVOICETITLE:d,INVOICECODE:n,INVOICENO:i,INVOICEDATE:t,INVOICEAMT:r,INVOICEMARK:"test remarks"}).then((e=>{u.success("操作成功"),o(),v.dialogShow=!1}))}))}};return m((()=>{Promise.all([O().then((e=>{const l=e.companies,a=[];for(let o=0;o<l.length;o++){const e=l[o];switch(v.CompanyTypeMap.get(e.type)){case"供应商":break;case"发票公司":a.push({label:e.name,id:e.name})}}v.invoiceCompanyOptions=a}))]).then((()=>{o()}))})),s((()=>v.dialogShow),(e=>{e||(v.addInvoiceForm={invoiceNumber:"",invoiceCode:"",invoiceDate:"",invoiceCompany:"",invoiceMoney:""})})),{state:v,...h,labelWidth:"90px",addInvoiceFormRules:{invoiceNumber:[{required:!0,message:"请输入发票号码",trigger:"blur"}],invoiceCode:[{required:!0,message:"请输入发票代码",trigger:"blur"}],invoiceDate:[{required:!0,message:"请选择账务日期",trigger:"change"}],invoiceCompany:[{required:!0,message:"请选择开票公司",trigger:"change"}],invoiceMoney:[{required:!0,message:"请输入发票金额",trigger:"blur"}]},...n}}}),N=_("开发票"),T=y("div",{class:"title"},"编辑",-1),E={class:"center-footer"},V=_("取消"),A=_("确认");e("default",o(f,[["render",function(e,l,a,o,i,n){const t=v("el-button"),d=v("styled-search"),r=v("el-table-column"),c=v("styled-table"),p=v("el-input"),u=v("el-form-item"),m=v("el-date-picker"),s=v("el-option"),_=v("el-select"),O=v("el-form"),f=v("el-dialog");return h(),b(I,null,[y(d,{"hide-search-more":""},{"styled-search-right":C((()=>[y(t,{type:"success",class:"export",onClick:e.handleAddInvoice,disabled:1!==e.state.multipleSelection.length},{default:C((()=>[N])),_:1},8,["onClick","disabled"])])),_:1}),y(c,{loading:e.state.loading,multiple:"",data:e.state.tableData,onChangeMultiple:e.handleChangeMultiple},{"table-columns":C((()=>[(h(!0),b(I,null,g(e.state.headersConfig,((l,a)=>(h(),b(r,{"show-overflow-tooltip":"",key:a,prop:l.prop,label:l.label,"min-width":e.calcHeaderWidth(l,a)},{header:C((e=>[y("span",null,D(e.column.label),1)])),default:C((e=>[y("span",null,D(e.row[l.prop]),1)])),_:2},1032,["prop","label","min-width"])))),128))])),_:1},8,["loading","data","onChangeMultiple"]),y(f,{width:"516px",modelValue:e.state.dialogShow,"onUpdate:modelValue":l[7]||(l[7]=l=>e.state.dialogShow=l)},{title:C((()=>[T])),footer:C((()=>[y("div",E,[y(t,{class:"cancel",onClick:l[6]||(l[6]=l=>e.state.dialogShow=!1)},{default:C((()=>[V])),_:1}),y(t,{type:"primary",class:"confirm",onClick:e.handleConfirmAddInvoice},{default:C((()=>[A])),_:1},8,["onClick"])])])),default:C((()=>[y(O,{ref:"addInvoiceFormRef",model:e.state.addInvoiceForm,rules:e.addInvoiceFormRules},{default:C((()=>[y(u,{label:"发票号码","label-width":e.labelWidth,prop:"invoiceNumber"},{default:C((()=>[y(p,{modelValue:e.state.addInvoiceForm.invoiceNumber,"onUpdate:modelValue":l[1]||(l[1]=l=>e.state.addInvoiceForm.invoiceNumber=l),type:"text",placeholder:"请输入发票号码"},null,8,["modelValue"])])),_:1},8,["label-width"]),y(u,{label:"发票代码","label-width":e.labelWidth,prop:"invoiceCode"},{default:C((()=>[y(p,{modelValue:e.state.addInvoiceForm.invoiceCode,"onUpdate:modelValue":l[2]||(l[2]=l=>e.state.addInvoiceForm.invoiceCode=l),type:"text",placeholder:"请输入发票代码"},null,8,["modelValue"])])),_:1},8,["label-width"]),y(u,{label:"发票日期","label-width":e.labelWidth,prop:"invoiceDate"},{default:C((()=>[y(m,{modelValue:e.state.addInvoiceForm.invoiceDate,"onUpdate:modelValue":l[3]||(l[3]=l=>e.state.addInvoiceForm.invoiceDate=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择日期"},null,8,["modelValue"])])),_:1},8,["label-width"]),y(u,{label:"发票抬头","label-width":e.labelWidth,prop:"invoiceCompany"},{default:C((()=>[y(_,{modelValue:e.state.addInvoiceForm.invoiceCompany,"onUpdate:modelValue":l[4]||(l[4]=l=>e.state.addInvoiceForm.invoiceCompany=l),placeholder:"请选择开票公司"},{default:C((()=>[(h(!0),b(I,null,g(e.state.invoiceCompanyOptions,(e=>(h(),b(s,{label:e.name,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label-width"]),y(u,{label:"发票金额","label-width":e.labelWidth,prop:"invoiceMoney"},{default:C((()=>[y(p,{modelValue:e.state.addInvoiceForm.invoiceMoney,"onUpdate:modelValue":l[5]||(l[5]=l=>e.state.addInvoiceForm.invoiceMoney=l),type:"text",placeholder:"请输入发票金额"},null,8,["modelValue"])])),_:1},8,["label-width"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])],64)}]]))}}}));
