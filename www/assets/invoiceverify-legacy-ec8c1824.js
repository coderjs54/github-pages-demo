System.register(["../vendors/element-plus-legacy-e48d1ae3.js","./index-legacy.acc39ef9.js"],(function(e){"use strict";var a,n,l,t,i,o,r,d,s,c,u,p,h,g,m,v,C,b,y,P,S,f,N;return{setters:[function(e){a=e.d,n=e.i,l=e.c,t=e.r,i=e.I,o=e.w,r=e.o,d=e.E,s=e.m,c=e.q,u=e.y,p=e.G,h=e.N,g=e.F,m=e.A,v=e.C,C=e.z},function(e){b=e.r,y=e.U,P=e._,S=e.u,f=e.d,N=e.b}],execute:function(){const V=a({name:"invoiceverify",setup(){const e=S(),a=f(),d=N(),s=n("setTableHeaders"),c=()=>{g.loading=!0;const{pageSize:e,currentPage:a}=i(g.pagination),{invoiceNumber:n,deliveryNumber:l,hospitalCode:t,invoiceProvider:o}=i(g.searchParam);(function(e){return b.post(y.INVOICE.queryInvoice,e)})({BeginPostingDate:"",EndPostingDate:"",InvoiceNo:n,DeliverOrderId:l,HospitalCode:t,ProviderName:o,VerifyStatus:"0",ApproveStatus:"2",PageNo:a,RecordPerPage:e}).then((e=>{g.pagination.total=e.TotalRecordCount,u(e.invoices)})).finally((()=>{g.loading=!1}))},u=e=>{g.tableData=e.map((e=>{const{INVOICEDATE:a,INVOICEAMT:n,INVOICENO:l,INVOICECODE:t,VerifyStatus:i,ProviderName:o}=e;return{invoiceNumber:l,invoiceSerialNumber:t,invoiceMoney:n,status:i?"已核销":"待核销",provider:o,invoiceCreateTime:a.substr(0,10)}}))},p=e=>{e&&(g.pagination.currentPage=1),c()},h=l((()=>g.headersConfig.filter((e=>!e.hidden)))),g=t({loading:!1,searchParam:{invoiceNumber:"",deliveryNumber:"",hospitalCode:"",invoiceProvider:""},pagination:{currentPage:1,total:0,pageSize:30},invoiceProviderOptions:[],multipleSelection:[],headersConfig:[{label:"发票号",prop:"invoiceNumber"},{label:"发票编号",prop:"invoiceSerialNumber"},{label:"发票金额",prop:"invoiceMoney"},{label:"状态",prop:"status"},{label:"供应商",prop:"provider"},{label:"开票时间",prop:"invoiceCreateTime"}],tableData:[]}),m={calcHeaderWidth:n("calcHeaderMinWidth"),handlePaginationChange(){p(!1)},handleClickSetting(){s(g.headersConfig,(e=>{g.headersConfig=e}))},handleChangeMultiple(e){g.multipleSelection=e},handleSearch(){p(!0)},handleGoVerify(){const a=i(g.multipleSelection);a.length&&e.push({name:"invoiceverifying",params:{chosenTableData:JSON.stringify(a)}})}};return o((()=>a.getters.settings),(()=>{g.headersConfig=a.getters.settings[d.name]||g.headersConfig})),r((()=>{Promise.all([b.post(y.INVOICE.queryInvoiceProvider,{}).then((e=>{g.invoiceProviderOptions=e.Providers.map((e=>({label:e,value:e})))}))]).then((()=>{c()}))})),{state:g,...m,headersShown:h}}}),I=v("查询");e("default",P(V,[["render",function(e,a,n,l,t,i){const o=d("el-input"),r=d("el-option"),b=d("el-select"),y=d("el-button"),P=d("styled-search"),S=d("el-table-column"),f=d("styled-table"),N=d("styled-pagination");return s(),c(g,null,[u(P,{"hide-search-more":""},{"styled-search-left":p((()=>[u(o,{modelValue:e.state.searchParam.invoiceNumber,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.searchParam.invoiceNumber=a),placeholder:"请输入发票号",clearable:"",onKeydown:h(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),u(o,{modelValue:e.state.searchParam.deliveryNumber,"onUpdate:modelValue":a[2]||(a[2]=a=>e.state.searchParam.deliveryNumber=a),placeholder:"请输入SAP交货单号",clearable:"",onKeydown:h(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),u(o,{modelValue:e.state.searchParam.hospitalCode,"onUpdate:modelValue":a[3]||(a[3]=a=>e.state.searchParam.hospitalCode=a),placeholder:"请输入院内码、系统码",clearable:"",onKeydown:h(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),u(b,{modelValue:e.state.searchParam.invoiceProvider,"onUpdate:modelValue":a[4]||(a[4]=a=>e.state.searchParam.invoiceProvider=a),placeholder:"请选择供应商",clearable:"",onChange:e.handleSearch},{default:p((()=>[(s(!0),c(g,null,m(e.state.invoiceProviderOptions,((e,a)=>(s(),c(r,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),u(y,{type:"primary",class:"search",onClick:e.handleSearch},{default:p((()=>[I])),_:1},8,["onClick"])])),"styled-search-right":p((()=>[u(y,{type:"primary",disabled:1!==e.state.multipleSelection.length,class:"search",onClick:e.handleGoVerify},{default:p((()=>[v("去核销("+C(e.state.multipleSelection.length)+")",1)])),_:1},8,["disabled","onClick"])])),_:1}),u(f,{setting:"",multiple:"",loading:e.state.loading,data:e.state.tableData,onChangeMultiple:e.handleChangeMultiple,onClickSetting:e.handleClickSetting},{"table-columns":p((()=>[(s(!0),c(g,null,m(e.headersShown,((a,n)=>(s(),c(S,{"show-overflow-tooltip":"",key:n,prop:a.prop,label:a.label,"min-width":e.calcHeaderWidth(a,n)},{header:p((e=>[u("span",null,C(e.column.label),1)])),default:p((e=>[u("span",null,C(e.row[a.prop]),1)])),_:2},1032,["prop","label","min-width"])))),128))])),_:1},8,["loading","data","onChangeMultiple","onClickSetting"]),u(N,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":a[5]||(a[5]=a=>e.state.pagination.currentPage=a),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":a[6]||(a[6]=a=>e.state.pagination.pageSize=a),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"])],64)}]]))}}}));
