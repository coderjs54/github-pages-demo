System.register([],(function(e){"use strict";return{execute:function(){const t=window.XLSX;e("_",new class{constructor(){var e,s,l;l=void 0,(s="xlsx")in(e=this)?Object.defineProperty(e,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[s]=l,this.xlsx=t}handleColumns(e){return e.reduce(((e,t)=>{const{label:s,prop:l}=t;return e.labels.push(s),e.props.push(l),e}),{labels:[],props:[]})}handleTableData(e,t,s){return[t].concat(s.map((t=>e.map((e=>t[e])))))}handleTableDataset(e,t){return t.reduce(((t,s)=>{const{group:l,data:a}=s;return t.dataset.push(a.map((t=>e.map((e=>t[e]))))),t.groups.push(l),t}),{groups:[],dataset:[]})}calcSheetHeaderMinWidth(e,t){t["!cols"]=e.map((e=>({wch:2*Math.max(null==e?void 0:e.length,5)})))}exportSingleSheet(e,t,s,l){const{labels:a,props:h}=this.handleColumns(e),i=this.handleTableData(h,a,t),o=this.xlsx.utils.book_new(),n=this.xlsx.utils.aoa_to_sheet(i);this.calcSheetHeaderMinWidth(a,n),this.xlsx.utils.book_append_sheet(o,n,s),this.xlsx.writeFile(o,`${l}.xlsx`)}exportAlertSingleSheet(e,t,s){const{labels:l,props:a}=this.handleColumns(e),{groups:h,dataset:i}=this.handleTableDataset(a,t),o=[];for(let x=0;x<h.length;x++){const e=h[x];o.push([e]),o.push(l);for(let t=0;t<i[x].length;t++){const e=i[x][t];o.push(e)}o.push([])}const n=this.xlsx.utils.book_new(),r=this.xlsx.utils.aoa_to_sheet(o);this.calcSheetHeaderMinWidth(l,r),this.xlsx.utils.book_append_sheet(n,r,"报警信息"),this.xlsx.writeFile(n,`${s}.xlsx`)}exportGiftSingleSheet(e,t){const{labels:s,props:l}=this.handleColumns(e),a=this.handleTableData(l,s,t);for(let r=0;r<5;r++)a.push([]);a.push(["供应商签字:____________    科室签字:____________"]);const h=this.xlsx.utils.book_new(),i=this.xlsx.utils.aoa_to_sheet(a),o=a.length,n=s.length;i["!merges"]=[{s:{c:0,r:o},e:{c:n-1,r:o-1}}],this.calcSheetHeaderMinWidth(s,i),this.xlsx.utils.book_append_sheet(h,i,"报警信息"),this.xlsx.writeFile(h,"赠品报警.xlsx")}exportInventoryCheckRecordsDetail(e,t){const s=this.xlsx.utils.book_new();for(let l=0;l<e.length;l++){const{columns:t,tableData:a,sheetname:h}=e[l],{labels:i,props:o}=this.handleColumns(t),n=this.handleTableData(o,i,a),r=this.xlsx.utils.aoa_to_sheet(n);this.calcSheetHeaderMinWidth(i,r),this.xlsx.utils.book_append_sheet(s,r,h)}this.xlsx.writeFile(s,`${t}.xlsx`)}})}}}));
