!function(){var e=document.createElement("style");e.innerHTML=".validate-message[data-v-25ccfe80]{margin-left:10px;font-size:14px}.validate-message img[data-v-25ccfe80]{width:14px;height:14px;margin-left:5px}.validate-message.error[data-v-25ccfe80]{color:#fa5151}.validate-message.success[data-v-25ccfe80]{color:#48bb64}\n",document.head.appendChild(e),System.register(["./index-legacy.acc39ef9.js","../vendors/element-plus-legacy-e48d1ae3.js","./index-legacy-4769daac.js","./failed-legacy-8aadbc20.js","./tip-legacy-d18ff986.js","./md5-legacy-47b02aeb.js"],(function(e){"use strict";var a,t,l,s,n,o,c,i,r,p,d,u,m,g,h,b,f,y,_,v,w,D,V,S,k,C,M,U,x;return{setters:[function(e){a=e._,t=e.u,l=e.b,s=e.d},function(e){n=e.d,o=e.r,c=e.c,i=e.i,r=e.S,p=e.w,d=e.O,u=e.Y,m=e.j,g=e.k,h=e.E,b=e.m,f=e.q,y=e.y,_=e.F,v=e.A,w=e.z,D=e.B,V=e.C},function(e){S=e.V},function(e){k=e.h,C=e.i,M=e._,U=e.a},function(e){x=e._},function(){}],execute:function(){const O=n({name:"dangeroutwarehousing",components:{"validate-acceptor-dialog":S},setup(){const e=t(),a=l(),n=s(),m={labelWidth:"90px",FROM_WHERE:"/dangeroutwarehouse"},g=o({headersConfig:[{label:"序号",prop:"id"},{label:"院内码",prop:"hospital_code"},{label:"库位",prop:"position1"},{label:"系统码",prop:"system_code"},{label:"物料名称",prop:"name"},{label:"物料简称",prop:"shortname"},{label:"物料批号",prop:"LotNumber"},{label:"品牌",prop:"brand"},{label:"组织名称",prop:"department"},{label:"操作员",prop:"Operator1Id"},{label:"库存量",prop:"inventory"},{label:"单位",prop:"unit"},{label:"领用数量",prop:"use_number"},{label:"批次单价",prop:"price"},{label:"物料规格",prop:"size"},{label:"物料类型",prop:"kind"},{label:"效期",prop:"validity",width:110},{label:"克隆号",prop:"CloneNumber"},{label:"病种类型",prop:"DiseaseType"}],tableData:[],acceptanceData:{acceptor1:c((()=>n.getters.username))},secondAcceptorList:[],acceptDialog:!1,accepting:!1,dialogValidateShow:!1,validateSuccess:!1,MinUnitTypeMap:c((()=>n.getters.MinUnitTypeMap))}),h={calcHeaderWidth:i("calcHeaderMinWidth"),handleOutWarehouse(){g.acceptDialog=!0},handleGoBack(){e.go(-1)},confirmOutWarehouse(){if(g.tableData.some((e=>Number(e.out_number)<=0)))return r.error("不允许将出库量设置为非正数，请您设置正确的出库量！");const a={UseHChemicals:g.tableData.map((e=>{const{id:a,use_unit:t,use_number:l}=e;return{StoreId:a,amount:l,unit:g.MinUnitTypeMap.get(t)}}))};g.accepting=!0,k(a).then((()=>{r.success("操作成功"),e.push(m.FROM_WHERE)})).finally((()=>{g.accepting=!1,g.acceptDialog=!1}))},handleValidateSuccess(){g.validateSuccess=!0}};return p((()=>n.getters.settings),(()=>{g.headersConfig=n.getters.settings[a.name]||g.headersConfig})),d((()=>{let t=a.params.chosenTableData;if(!t)return e.push(m.FROM_WHERE);if(t=JSON.parse(t),!t.length)return e.push(m.FROM_WHERE);g.tableData=t.map((e=>{const{material:a}=e,{inOutStoreUnits:t,unitMultiples:l}=a,s=t.slice(1,-1).split(",").at(-1);return{...e,use_number:0,use_unit:g.MinUnitTypeMap.get(s)}}));const l=g.tableData.map((e=>e.DepartmentId));C(l).then((e=>{g.secondAcceptorList=e.inspectors.map((e=>({label:e.UserDisplayName,value:e.UserName}))),0===g.secondAcceptorList.length&&(1===g.tableData.length?u({title:"提示",message:"暂时找不到可以作为此危险品的第二见证人，请联系部门管理员进行添加。",type:"warning",duration:0}):u({title:"提示",message:"暂时找不到可以同时作为这些危险品的第二见证人，请返回重新选择。",type:"warning",duration:0}))}))})),{state:g,...h,...m}}}),W=D();m("data-v-25ccfe80");const E=y("img",{class:"verified-img1",src:M,alt:"验证成功"},null,-1),H=V("双人双锁验证"),R={key:0,class:"validate-message success"},j=y("span",null,"双人双锁已验证",-1),T=y("img",{src:M,alt:"验证成功"},null,-1),L={key:1,class:"validate-message error"},N=y("span",null,"双人双锁未验证",-1),A=y("img",{src:U,alt:"验证失败"},null,-1),F=V("确定领用 "),I=V("返回选择"),z={style:{"margin-left":"8px"}},B={key:1},G=y("div",{class:"title"},"提示",-1),q={class:"tip-body"},J=y("img",{src:x,alt:""},null,-1),Y=V("确认要对选中的"),K={class:"item-name"},P=V("个物料进行领用吗?"),Q={class:"right-footer"},X=V("取消"),Z=V("确定");g();e("default",a(O,[["render",W(((e,a,t,l,s,n)=>{const o=h("el-input"),c=h("el-form-item"),i=h("el-button"),r=h("el-form"),p=h("styled-search"),d=h("el-table-column"),u=h("styled-table"),m=h("validate-acceptor-dialog"),g=h("el-dialog");return b(),f(_,null,[y(p,{"hide-search-more":""},{"styled-search-left":W((()=>[y(r,{class:"danger-accepting",inline:!0,model:e.state.acceptanceData,"label-position":"right"},{default:W((()=>[y(c,{label:"领用人"},{default:W((()=>[y(o,{disabled:"",modelValue:e.state.acceptanceData.acceptor1,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.acceptanceData.acceptor1=a),placeholder:"请输入领用人"},null,8,["modelValue"]),E])),_:1}),y(c,null,{default:W((()=>[y(i,{type:"primary",onClick:a[2]||(a[2]=a=>e.state.dialogValidateShow=!0)},{default:W((()=>[H])),_:1}),e.state.validateSuccess?(b(),f("span",R,[j,T])):(b(),f("span",L,[N,A]))])),_:1})])),_:1},8,["model"])])),"styled-search-right":W((()=>[y(i,{type:"primary",class:"search",onClick:e.handleOutWarehouse,disabled:!e.state.validateSuccess},{default:W((()=>[F])),_:1},8,["onClick","disabled"]),y(i,{type:"primary",plain:"",onClick:e.handleGoBack},{default:W((()=>[I])),_:1},8,["onClick"])])),_:1}),y(u,{setting:"",data:e.state.tableData},{"table-columns":W((()=>[(b(!0),f(_,null,v(e.state.headersConfig,((a,t)=>(b(),f(d,{"show-overflow-tooltip":"",key:t,prop:a.prop,label:a.label,"min-width":e.calcHeaderWidth(a,t)},{header:W((e=>[y("span",null,w(e.column.label),1)])),default:W((e=>["use_number"===e.column.property?(b(),f(_,{key:0},[y(o,{size:"small",style:{width:"calc(100% - 25px)"},type:"text",modelValue:e.row[a.prop],"onUpdate:modelValue":t=>e.row[a.prop]=t},null,8,["modelValue","onUpdate:modelValue"]),y("span",z,w(e.row.use_unit),1)],64)):(b(),f("span",B,w(e.row[a.prop]),1))])),_:2},1032,["prop","label","min-width"])))),128))])),_:1},8,["data"]),y(m,{purpose:"Use",param:"StoreIds","dialog-show":e.state.dialogValidateShow,"onUpdate:dialog-show":a[3]||(a[3]=a=>e.state.dialogValidateShow=a),acceptors:e.state.secondAcceptorList,ids:e.state.tableData.map((e=>e.id)),onValidateSuccess:e.handleValidateSuccess},null,8,["dialog-show","acceptors","ids","onValidateSuccess"]),y(g,{width:"466px",modelValue:e.state.acceptDialog,"onUpdate:modelValue":a[5]||(a[5]=a=>e.state.acceptDialog=a)},{title:W((()=>[G])),footer:W((()=>[y("div",Q,[y(i,{onClick:a[4]||(a[4]=a=>e.state.acceptDialog=!1),class:"cancel"},{default:W((()=>[X])),_:1}),y(i,{type:"primary",loading:e.state.accepting,onClick:e.confirmOutWarehouse,class:"confirm"},{default:W((()=>[Z])),_:1},8,["loading","onClick"])])])),default:W((()=>[y("div",q,[J,y("span",null,[Y,y("span",K,w(e.state.tableData.length),1),P])])])),_:1},8,["modelValue"])],64)}))],["__scopeId","data-v-25ccfe80"]]))}}}))}();
