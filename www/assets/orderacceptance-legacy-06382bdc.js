System.register(["../vendors/element-plus-legacy-e48d1ae3.js","./index-legacy.acc39ef9.js","./tip-legacy-d18ff986.js"],(function(e){"use strict";var a,l,t,n,r,o,i,d,c,s,p,h,u,g,m,b,D,C,S,f,P,y,O,N,v,T;return{setters:[function(e){a=e.d,l=e.a,t=e.i,n=e.r,r=e.c,o=e.I,i=e.S,d=e.w,c=e.o,s=e.E,p=e.m,h=e.q,u=e.y,g=e.G,m=e.N,b=e.C,D=e.z,C=e.F,S=e.A},function(e){f=e.r,P=e.U,y=e._,O=e.u,N=e.b,v=e.d},function(e){T=e._}],execute:function(){const w=a({name:"orderacceptance",setup(){const e=O(),a=N(),s=v(),p={scanCodeRef:l(null)},h=t("setTableHeaders"),u=()=>{m.loading=!0;const{pageSize:e,currentPage:a}=o(m.pagination),{dateRange:l,SOID:t,invoiceNumber:n,shortname:r,supplier:i}=o(m.searchParam),[d,c]=l||["",""];(function(e){return f.post(P.DELIVERY.queryMiddleTableDelivery,e)})({DeliverOrderId:t,SearchWord:r,RequestPurchaseBeginDate:d,RequestPurchaseEndDate:c,InvoiceNo:n,ProviderName:i,NeedCheckIsAccept:!0,IsAccept:!1,NeedCheckHChemical:!0,IsHChemical:!1,NeedPaging:!0,PageNumber:a,RecordPerPage:e}).then((e=>{m.pagination.total=e.TotalRecordCount,g(e.DeliverOrders)})).finally((()=>{m.loading=!1}))},g=e=>{m.tableData=e.map((e=>{const{material:a,deliverOrder:l}=e;return{...l,shortname:null==a?void 0:a.short_name,standard:null==a?void 0:a.spec,brandName:m.brandIdMap[null==a?void 0:a.brand_id],department_name:l.DepartmentName,SODATE:l.SODATE.replace("T"," "),ENDDATE:l.ENDDATE.substr(0,10),material_name:null==a?void 0:a.name,store_pos:null==a?void 0:a.storePos}}))},m=n({loading:!1,searchParam:{dateRange:"",SOID:"",invoiceNumber:"",shortname:"",supplier:""},pagination:{currentPage:1,total:0,pageSize:30},headersConfig:[{label:"序号",prop:"id"},{label:"交货单ID",prop:"SOID"},{label:"交货单号",prop:"SONO"},{label:"物料名称",prop:"material_name"},{label:"物料简称",prop:"shortname"},{label:"物料规格",prop:"standard"},{label:"品牌",prop:"brandName"},{label:"部门名称",prop:"department_name"},{label:"交货日期",prop:"SODATE"},{label:"采购单号",prop:"PONO"},{label:"采购单明细号",prop:"PODETNO"},{label:"院内码",prop:"DITEMCODE"},{label:"送货数量",prop:"DQTY"},{label:"单位",prop:"DPACKUNIT"},{label:"含税单价",prop:"DTAXPRC"},{label:"含税金额",prop:"TAXAMT"},{label:"批号",prop:"LOTNO"},{label:"效期",prop:"ENDDATE",width:160},{label:"税率",prop:"TAXRATE"}],tableData:[],multipleSelection:[],brandIdMap:r((()=>s.getters.brandIdMap)),batchDeleteDialog:!1,batchDeleteData:{SOGRPNO:""}}),b=e=>{e&&(m.pagination.currentPage=1),u()},D=r((()=>m.headersConfig.filter((e=>!e.hidden)))),C={calcHeaderWidth:t("calcHeaderMinWidth"),handleClickSetting(){h(m.headersConfig,(e=>{m.headersConfig=e}))},handleChangeMultiple(e){m.multipleSelection=e},handlePaginationChange(){b(!1)},handleSearch(){b(!0)},handleScanKeyDownEnter(){b(!0)},handleGoToAccept(){const a=o(m.multipleSelection);e.push({name:"orderaccepting",params:{chosenTableData:JSON.stringify(a)}})},handleBatchDeleteDelivery(e){m.batchDeleteData.SOGRPNO=e.SOGRPNO,m.batchDeleteDialog=!0},confirmBatchDelete(){(function(e){return f.post(P.DELIVERY.deleteDeliveryOrder,e)})({SOGRPNO:m.batchDeleteData.SOGRPNO}).then((()=>{i.success("操作成功"),u(),m.batchDeleteDialog=!1}))}};return d((()=>s.getters.settings),(()=>{m.headersConfig=s.getters.settings[a.name]||m.headersConfig})),d((()=>m.batchDeleteDialog),(e=>{e||(m.batchDeleteData={SOGRPNO:""})})),c((()=>{p.scanCodeRef.value.focus(),u()})),{state:m,...p,...C,headersShown:D}}}),E={class:"date-box"},R=b("查询"),V=b("删除"),I=u("div",{class:"title"},"提示",-1),_=u("div",{class:"tip-body"},[u("img",{src:T,alt:""}),u("span",null,[b("确认要"),u("span",{class:"highlight-text"},"删除"),b("所选择的交货单吗?")])],-1),k={class:"right-footer"},A=b("取消"),M=b("确定");e("default",y(w,[["render",function(e,a,l,t,n,r){const o=s("el-date-picker"),i=s("el-input"),d=s("el-button"),c=s("styled-search"),f=s("el-table-column"),P=s("styled-table"),y=s("styled-pagination"),O=s("el-dialog");return p(),h(C,null,[u(c,{"hide-search-more":""},{"styled-search-left":g((()=>[u("div",E,[u(o,{modelValue:e.state.searchParam.dateRange,"onUpdate:modelValue":a[1]||(a[1]=a=>e.state.searchParam.dateRange=a),type:"daterange","value-format":"YYYY-MM-DD","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),u(i,{ref:"scanCodeRef",modelValue:e.state.searchParam.SOID,"onUpdate:modelValue":a[2]||(a[2]=a=>e.state.searchParam.SOID=a),placeholder:"交货单号扫码",clearable:"",onKeydown:m(e.handleScanKeyDownEnter,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),u(i,{modelValue:e.state.searchParam.invoiceNumber,"onUpdate:modelValue":a[3]||(a[3]=a=>e.state.searchParam.invoiceNumber=a),placeholder:"请输入发票号",clearable:"",onKeydown:m(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),u(i,{modelValue:e.state.searchParam.shortname,"onUpdate:modelValue":a[4]||(a[4]=a=>e.state.searchParam.shortname=a),placeholder:"请输入物料名称、简称",clearable:"",onKeydown:m(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),u(i,{modelValue:e.state.searchParam.supplier,"onUpdate:modelValue":a[5]||(a[5]=a=>e.state.searchParam.supplier=a),placeholder:"请输入供应商名称",clearable:"",onKeydown:m(e.handleSearch,["enter"]),onClear:e.handleSearch},null,8,["modelValue","onKeydown","onClear"]),u(d,{type:"primary",class:"search",onClick:e.handleSearch},{default:g((()=>[R])),_:1},8,["onClick"])])),"styled-search-right":g((()=>[u(d,{type:"primary",disabled:0===e.state.multipleSelection.length,class:"search",onClick:e.handleGoToAccept},{default:g((()=>[b("去验收("+D(e.state.multipleSelection.length)+")",1)])),_:1},8,["disabled","onClick"])])),_:1}),u(P,{loading:e.state.loading,multiple:"",setting:"",data:e.state.tableData,onChangeMultiple:e.handleChangeMultiple,onClickSetting:e.handleClickSetting},{"table-columns":g((()=>[(p(!0),h(C,null,S(e.headersShown,((a,l)=>(p(),h(f,{"show-overflow-tooltip":"",key:l,prop:a.prop,label:a.label,"min-width":e.calcHeaderWidth(a,l)},{header:g((e=>[u("span",null,D(e.column.label),1)])),default:g((e=>[u("span",null,D(e.row[a.prop]),1)])),_:2},1032,["prop","label","min-width"])))),128)),u(f,{label:"操作",fixed:"right",width:"80"},{default:g((a=>[u(d,{type:"text",class:"delete",onClick:l=>e.handleBatchDeleteDelivery(a.row)},{default:g((()=>[V])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["loading","data","onChangeMultiple","onClickSetting"]),u(y,{total:e.state.pagination.total,"current-page":e.state.pagination.currentPage,"onUpdate:current-page":a[6]||(a[6]=a=>e.state.pagination.currentPage=a),"page-size":e.state.pagination.pageSize,"onUpdate:page-size":a[7]||(a[7]=a=>e.state.pagination.pageSize=a),onPaginationChange:e.handlePaginationChange},null,8,["total","current-page","page-size","onPaginationChange"]),u(O,{width:"466px",modelValue:e.state.batchDeleteDialog,"onUpdate:modelValue":a[9]||(a[9]=a=>e.state.batchDeleteDialog=a)},{title:g((()=>[I])),footer:g((()=>[u("div",k,[u(d,{onClick:a[8]||(a[8]=a=>e.state.batchDeleteDialog=!1),class:"cancel"},{default:g((()=>[A])),_:1}),u(d,{type:"primary",onClick:e.confirmBatchDelete,class:"confirm"},{default:g((()=>[M])),_:1},8,["onClick"])])])),default:g((()=>[_])),_:1},8,["modelValue"])],64)}]]))}}}));
